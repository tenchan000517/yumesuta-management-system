# ゆめマガ進捗管理システム改善 - 最終プロジェクト計画書

**作成日**: 2025-10-07
**PM**: Claude Code (前任)
**ステータス**: 計画確定・実装フェーズ開始
**完成目標**: 7フェーズ完了（総工数: 約32時間）

---

## 🎯 プロジェクトゴール

**一人でゆめマガ制作全体を管理できる進捗管理システムの完成**

### 達成条件

1. ✅ カテゴリが動的に管理できる（ハードコード削除）
2. ✅ 依存関係に基づく「準備OK」判定ができる
3. ✅ 遅延工程が自動検出される
4. ✅ 企業情報が一元管理され、yumesutaHPと同期できる
5. ✅ フレキシブルな企画に対応できる（カスタム工程追加）
6. ✅ 作業アシスト機能で効率化できる

---

## 📐 設計方針（確定版）

### 1. シンプル原則

- **複雑化しない**: PROC-001のような抽象化はしない
- **既存構造を活用**: 新規シート追加は最小限
- **スプレッドシート中心**: データはすべてGoogle Sheetsで管理

### 2. データ構造

#### 新規作成シート（3つ）

1. **カテゴリマスター**
   - カテゴリID、カテゴリ名、確認送付必須、表示順
   - 全15カテゴリ（A, K, H, I, L, M, C, E, P, Z, B, F, J, N, S）

2. **企業マスター**
   - 企業ID、企業名、代表者名、画像URL、連絡先
   - コンテンツ（社長あいさつ、企業紹介、社員の声）
   - 初掲載号、最終更新号で新規/既存を判別

3. **作業アシストマスター**
   - 工程No、ツール名、ツールURL、プロンプト内容
   - Google Studio連携用

#### 修正シート（1つ）

- **新工程マスター**: 工程名からカテゴリ情報を削除
  - 変更前: `A-3: メイン文字起こし`
  - 変更後: `A-3: 文字起こし`

---

## 🗂️ 実装フェーズ（7フェーズ）

### Phase 0: 事前準備（スプレッドシート作業）

**担当**: ユーザー（手動作業）
**工数**: 2-3時間

#### タスク

1. **カテゴリマスター作成**
   - シート名: `カテゴリマスター`
   - 15カテゴリのデータ入力
   - データ構造は後述の「スプレッドシート作業指示書」参照

2. **企業マスター作成**
   - シート名: `企業マスター`
   - 現在の6社のデータ入力
   - 社長あいさつ・社員の声も入力

3. **作業アシストマスター作成**
   - シート名: `作業アシストマスター`
   - 文字起こし工程のプロンプト登録

4. **新工程マスターのクリーンナップ**
   - 工程名からカテゴリ情報を削除
   - 例: `メイン文字起こし` → `文字起こし`

**完了条件**: 3つの新規シートが作成され、新工程マスターの工程名が整理されている

---

### Phase 1: カテゴリの動的管理

**優先度**: 🔴 最高
**工数**: 4時間
**担当**: 実装担当者

#### 実装タスク

1. **カテゴリ取得API作成**
   - ファイル: `/app/api/yumemaga-v2/categories/route.ts`
   - カテゴリマスターからデータ取得
   - 返却: カテゴリID、カテゴリ名、確認送付必須、表示順

2. **フロントエンド修正**
   - ファイル: `/app/dashboard/yumemaga-v2/page.tsx`
   - ハードコード削除:
     - `getCategoryName()` 関数削除
     - `getRequiredData()` 関数削除
     - 確認必須カテゴリ配列削除
   - カテゴリメタデータを状態管理

3. **progress API修正**
   - ファイル: `/app/api/yumemaga-v2/progress/route.ts`
   - カテゴリハードコード削除
   - 動的にカテゴリを抽出

#### 成功基準

- ✅ 全15カテゴリが表示される
- ✅ カテゴリ名がカテゴリマスターから取得される
- ✅ 新カテゴリ追加時にコード修正不要

#### テスト項目

- [ ] カテゴリAPI (`/api/yumemaga-v2/categories`) が正常に動作
- [ ] 15カテゴリすべてが表示される
- [ ] カテゴリ名が正しく表示される
- [ ] 確認送付必須フラグが正しく機能する

---

### Phase 2: 依存関係ベースの準備OK判定

**優先度**: 🔴 高
**工数**: 6時間
**担当**: 実装担当者

#### 実装タスク

1. **準備OK判定API作成**
   - ファイル: `/app/api/yumemaga-v2/ready-processes/route.ts`
   - 新依存関係マスターを活用
   - 前提工程が完了した工程を「準備OK」と判定
   - 予定日を過ぎた未完了工程を「遅延」と判定

2. **UI表示**
   - 工程カードに準備OK・遅延バッジを表示
   - 遅延日数を表示

#### 成功基準

- ✅ 前提工程完了時に「準備OK」バッジが表示
- ✅ 予定日超過時に「遅延」アラートが表示
- ✅ 遅延日数が正確に計算される

#### テスト項目

- [ ] 依存関係が正しく読み込まれる
- [ ] 準備OK判定が正確に動作する
- [ ] 遅延判定が正確に動作する
- [ ] バッジが正しく表示される

---

### Phase 3: Z・Bカテゴリの専用セクション

**優先度**: 🔴 高
**工数**: 3時間
**担当**: 実装担当者

#### 実装タスク

1. **専用セクションコンポーネント作成**
   - ファイル: `/components/yumemaga-v2/OverallProgressSection.tsx`
   - Zカテゴリ（全体進捗）専用UI
   - Bカテゴリ（全体調整）専用UI

2. **メインページに統合**
   - Zカテゴリ・Bカテゴリを別枠で表示
   - 他のカテゴリとは区別

#### 成功基準

- ✅ Z・Bカテゴリが専用セクションに表示される
- ✅ 他のカテゴリとは別枠で管理される

#### テスト項目

- [ ] Zカテゴリ工程が専用セクションに表示
- [ ] Bカテゴリ工程が専用セクションに表示
- [ ] 実績日入力が正常に動作

---

### Phase 4: カテゴリ同期マスターの活用

**優先度**: 🟡 中
**工数**: 4時間
**担当**: 実装担当者

#### 実装タスク

1. **カテゴリ同期マスター取得API**
   - ファイル: `/app/api/yumemaga-v2/category-sync/route.ts`
   - カテゴリ同期マスターから取得

2. **確認送付グループの一元管理**
   - 「確認送付」グループの工程を一括表示
   - グループ単位でのステータス管理

#### 成功基準

- ✅ カテゴリ同期マスターから動的にグループを取得
- ✅ 確認送付グループが一括管理される

#### テスト項目

- [ ] カテゴリ同期マスターが正しく読み込まれる
- [ ] 確認送付グループが表示される

---

### Phase 5: 作業アシスト機能

**優先度**: 🟡 中
**工数**: 5時間
**担当**: 実装担当者

#### 実装タスク

1. **作業アシスト取得API**
   - ファイル: `/app/api/yumemaga-v2/work-assist/route.ts`
   - 作業アシストマスターから取得

2. **UIモーダル表示**
   - 工程カードに「アシスト」ボタン
   - Google Studioへのリンク
   - プロンプトのコピーボタン

#### 成功基準

- ✅ 文字起こし工程でアシストボタンが表示
- ✅ Google Studioへのリンクが機能
- ✅ プロンプトがコピー可能

#### テスト項目

- [ ] アシストボタンが表示される
- [ ] モーダルが開く
- [ ] プロンプトがコピーできる
- [ ] Google Studioリンクが機能する

---

### Phase 6: フレキシブル企画対応

**優先度**: 🟡 中
**工数**: 4時間
**担当**: 実装担当者

#### 実装タスク

1. **カスタム工程追加API**
   - ファイル: `/app/api/yumemaga-v2/custom-process/route.ts`
   - 進捗入力シートに新行追加

2. **UI: カスタム工程追加フォーム**
   - 各カテゴリに「+ カスタム工程」ボタン
   - 工程名・予定日・必要データ入力

#### 成功基準

- ✅ カスタム工程を追加できる
- ✅ 追加した工程が表示される
- ✅ 実績日を入力できる

#### テスト項目

- [ ] カスタム工程追加フォームが表示される
- [ ] カスタム工程が正しく追加される
- [ ] 追加した工程が進捗管理に表示される

---

### Phase 7: 企業紹介ページ管理

**優先度**: 🟢 低
**工数**: 6時間
**担当**: 実装担当者

#### 実装タスク

1. **企業情報取得API**
   - ファイル: `/app/api/yumemaga-v2/companies/route.ts`
   - 企業マスターから取得

2. **企業ステータス判定**
   - 新規企業 / 既存企業（変更あり） / 既存企業（変更なし）を判別

3. **UI: 企業カード表示**
   - C・Eカテゴリに企業情報を表示
   - 社長あいさつ・社員の声を表示

#### 成功基準

- ✅ 企業が新規か既存かを判別できる
- ✅ 企業情報が表示される
- ✅ コンテンツが確認できる

#### テスト項目

- [ ] 企業マスターが正しく読み込まれる
- [ ] 企業ステータスが正しく判別される
- [ ] 企業カードが表示される
- [ ] コンテンツが表示される

---

## 📋 成果物チェックリスト

### ドキュメント

- [x] プロジェクト計画書（本ドキュメント）
- [ ] スタートプロンプト
- [ ] 進捗報告シート
- [ ] スプレッドシート作業指示書
- [ ] 実装チェックリスト

### スプレッドシート（Phase 0）

- [ ] カテゴリマスター作成
- [ ] 企業マスター作成
- [ ] 作業アシストマスター作成
- [ ] 新工程マスタークリーンナップ

### API実装

- [ ] `/api/yumemaga-v2/categories` (Phase 1)
- [ ] `/api/yumemaga-v2/ready-processes` (Phase 2)
- [ ] `/api/yumemaga-v2/category-sync` (Phase 4)
- [ ] `/api/yumemaga-v2/work-assist` (Phase 5)
- [ ] `/api/yumemaga-v2/custom-process` (Phase 6)
- [ ] `/api/yumemaga-v2/companies` (Phase 7)

### UI実装

- [ ] カテゴリハードコード削除 (Phase 1)
- [ ] 準備OK・遅延バッジ (Phase 2)
- [ ] Z・B専用セクション (Phase 3)
- [ ] 作業アシストモーダル (Phase 5)
- [ ] カスタム工程追加フォーム (Phase 6)
- [ ] 企業カード表示 (Phase 7)

---

## 🎯 最終目標

**Phase 0-7が完了し、全テスト項目がパスすれば、プロジェクト完成**

### 完成時の状態

1. ✅ カテゴリマスターから動的に15カテゴリを管理
2. ✅ 依存関係に基づく準備OK・遅延アラートが機能
3. ✅ Z・Bカテゴリが専用セクションで管理される
4. ✅ 企業情報が一元管理され、yumesutaHPと同期可能
5. ✅ フレキシブルな企画にカスタム工程で対応
6. ✅ 作業アシスト機能で効率化
7. ✅ 全機能が統合され、一人で管理可能

---

**作成者**: Claude Code (PM)
**最終更新**: 2025-10-07
**次のアクション**: スタートプロンプト作成 → 進捗報告シート作成 → Phase 0開始
