# Phase 0: GASによる自動セットアップガイド

**作成日**: 2025-10-08
**所要時間**: 5分（自動化済み）
**対象**: ユーザー

---

## 🎯 Phase 0でやること

Phase 0では、以下の4つのシートを自動作成します：

1. ✅ **カテゴリマスター**（15カテゴリ）
2. ✅ **企業マスター**（6社・実データ完全反映）✨ **yumesutaHPから実データ抽出済み**
3. ✅ **作業アシストマスター**（6工程のAI支援プロンプト）
4. ✅ **新工程マスタークリーンナップ**（工程名の整理）

**従来**: 手動作業で2-3時間
**GAS自動化**: ボタン1つで1分以内に完了

---

## 📋 セットアップ手順

### Step 1: Google Sheetsを開く

スプレッドシートを開いてください：

```
スプレッドシートID: 1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw
```

または、以下のURLから直接アクセス：

```
https://docs.google.com/spreadsheets/d/1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw/edit
```

---

### Step 2: Apps Scriptエディタを開く

1. Google Sheetsのメニューから **「拡張機能」** をクリック
2. **「Apps Script」** を選択
3. Apps Scriptエディタが開きます

![Apps Scriptを開く](https://i.imgur.com/placeholder.png)

---

### Step 3: スクリプトをコピー&ペースト

1. エディタの既存コードを**すべて削除**
2. 以下のファイルの内容を**すべてコピー**:

```
docs/yumemaga-production-management/phase0-setup.gs
```

3. Apps Scriptエディタに**ペースト**
4. **保存**（💾アイコン、または `Ctrl+S` / `Cmd+S`）
5. プロジェクト名を「Phase 0セットアップ」に変更（任意）

![スクリプトをペースト](https://i.imgur.com/placeholder.png)

---

### Step 4: 初回実行（権限承認）

1. エディタ上部の関数選択で **`onOpen`** を選択
2. **「実行」**（▶️ボタン）をクリック
3. 権限の確認ダイアログが表示されます：
   - 「権限を確認」をクリック
   - Googleアカウントを選択
   - 「詳細」→「Phase 0セットアップ（安全ではないページ）に移動」
   - 「許可」をクリック

**注意**: 「安全ではないページ」と表示されますが、これは自作スクリプトのためです。問題ありません。

![権限承認](https://i.imgur.com/placeholder.png)

---

### Step 5: スプレッドシートに戻る

1. Apps Scriptエディタを閉じる
2. Google Sheetsのタブに戻る
3. **ページをリロード**（F5または更新ボタン）
4. メニューバーに **「Phase 0」** メニューが追加されていることを確認

![Phase 0メニュー](https://i.imgur.com/placeholder.png)

---

### Step 6: Phase 0を実行

1. メニューバーの **「Phase 0」** をクリック
2. **「✅ 全シート自動作成」** をクリック
3. 確認ダイアログが表示されます：
   ```
   Phase 0セットアップ開始

   以下の処理を実行します:

   1. カテゴリマスター作成（15カテゴリ）
   2. 企業マスター作成（6社テンプレート）
   3. 作業アシストマスター作成（6工程）
   4. 新工程マスタークリーンナップ

   既存のシートは上書きされます。続行しますか？
   ```
4. **「はい」** をクリック
5. 処理が実行されます（約1分）
6. 完了ダイアログが表示されます：
   ```
   ✅ Phase 0セットアップ完了！

   以下のシートが作成されました:

   ✅ カテゴリマスター（15カテゴリ）
   ✅ 企業マスター（6社テンプレート）
   ✅ 作業アシストマスター（6工程）
   ✅ 新工程マスタークリーンナップ完了

   次のステップ: Phase 1（カテゴリ動的管理）の実装
   ```

---

## ✅ 完了確認

### 自動チェック機能

「Phase 0」メニュー → **「🔍 Phase 0完了チェック」** をクリックすると、以下をチェックできます：

- ✅ カテゴリマスターが存在するか（15カテゴリ以上）
- ✅ 企業マスターが存在するか（6社以上）
- ✅ 作業アシストマスターが存在するか（6工程以上）
- ✅ 新工程マスターが存在するか

すべて✅なら、Phase 0完了です！

---

## 📊 作成されるシート詳細

### 1. カテゴリマスター

| カテゴリID | カテゴリ名 | 確認送付必須 | 表示順 | ステータス |
|-----------|-----------|------------|--------|-----------|
| A | メインインタビュー | TRUE | 1 | active |
| K | インタビュー② | TRUE | 2 | active |
| H | STAR① | TRUE | 3 | active |
| ... | ... | ... | ... | ... |
| **合計15カテゴリ** |

### 2. 企業マスター ✨ **実データ完全反映版**

6社分の実データが作成されます（yumesutaHPから抽出）：

- **株式会社マルトモ**（完全データ）
- **あーきぺんこ**（完全データ）
- **株式会社テクノシンエイ**（完全データ）
- **稲垣製作所株式会社**（実データ反映済み）
- **一榮工業株式会社**（実データ反映済み）
- **(有)林工業所**（完全データ）

**62列の詳細データ**:
- 基本情報（企業ID、企業名、業種、エリア、説明文、ロゴ、ヒーロー画像、QRコード、スローガン、代表者情報）
- サービス情報（3つのサービス：画像パス、タイトル、説明）
- 社長メッセージ（長文）
- 社員の声（3名：画像パス、質問、回答）
- 企業の取り組み（3項目：タイトル、説明）
- 企業情報（住所、電話、FAX、ウェブサイト、メール、設立年、従業員数、事業内容）
- メタ情報（初掲載号、最終更新号、ステータス、備考）

**GASスクリプト**: `company-master-setup.gs` または `update-inagaki-ichiei.gs`（更新のみ）

### 3. 作業アシストマスター

文字起こし6工程にAI支援プロンプトが登録されます：

- A-3: 文字起こし
- K-3: 文字起こし
- L-5: 文字起こし
- M-5: 文字起こし
- H-3: 文字起こし
- I-3: 文字起こし

### 4. 新工程マスタークリーンナップ

工程名からカテゴリ情報が削除されます：

| 変更前 | 変更後 |
|--------|--------|
| メイン文字起こし | 文字起こし |
| インタビュー②文字起こし | 文字起こし |
| STAR①文字起こし | 文字起こし |

---

## 🔧 個別実行オプション

一括実行ではなく、シートごとに個別に作成したい場合：

「Phase 0」メニュー:
- **「1️⃣ カテゴリマスター作成」** → カテゴリマスターのみ作成
- **「2️⃣ 企業マスター作成」** → 企業マスターのみ作成
- **「3️⃣ 作業アシストマスター作成」** → 作業アシストマスターのみ作成
- **「4️⃣ 新工程マスタークリーンナップ」** → クリーンナップのみ実行

---

## ⚠️ トラブルシューティング

### 「Phase 0」メニューが表示されない

**原因**: スクリプトが正しく保存されていない、またはページがリロードされていない

**対処法**:
1. Apps Scriptエディタでスクリプトが保存されているか確認
2. Google Sheetsをリロード（F5）
3. それでも表示されない場合、Step 4（初回実行）をもう一度実行

### 「権限がありません」エラー

**原因**: Google Sheetsへのアクセス権限がない

**対処法**:
1. Apps Scriptエディタで「実行」→「onOpen」を実行
2. 権限承認ダイアログで「許可」をクリック

### 「シートが既に存在します」エラー

**原因**: 既存のシートが存在する

**対処法**:
- スクリプトは既存シートを自動で削除して再作成します
- エラーが出る場合は、手動で既存シートを削除してから再実行

### スクリプトが途中で止まる

**原因**: スプレッドシートのデータが大きすぎる、またはネットワークエラー

**対処法**:
1. ページをリロード
2. 個別実行オプションを使って1シートずつ作成
3. Apps Scriptエディタの「実行ログ」を確認（表示 → ログ）

---

## 📝 次のステップ

Phase 0が完了したら：

1. ✅ **企業マスターのデータを実際の企業情報に書き換える**（任意）
2. ✅ **Phase 1（カテゴリ動的管理）の実装に進む**

Phase 1の実装手順は以下を参照：

```
docs/yumemaga-production-management/START_PROMPT.md
```

---

## 🆘 サポート

質問がある場合は、以下のドキュメントを参照：

- **プロジェクト計画書**: `docs/yumemaga-production-management/PROJECT_PLAN_FINAL.md`
- **進捗報告シート**: `docs/yumemaga-production-management/PROGRESS_REPORT.md`
- **スタートプロンプト**: `docs/yumemaga-production-management/START_PROMPT.md`

---

**作成者**: Claude Code
**最終更新**: 2025-10-08
**次のフェーズ**: Phase 1（カテゴリ動的管理）
