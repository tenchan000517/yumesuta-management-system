/**
 * 企業マスター v2 専用セットアップスクリプト
 *
 * 【目的】
 * yumesutaHPの5社すべての実データを企業マスターに反映する
 *
 * 【KGI】
 * 全6社（マルトモ、あーきぺんこ、テクノシンエイ、稲垣製作所、一榮工業、林工業所）の
 * 完全なデータをスプレッドシートに反映すること
 *
 * 使い方:
 * 1. Google Sheetsで「拡張機能」→「Apps Script」を開く
 * 2. このスクリプトをコピー&ペースト
 * 3. 保存して「onOpen」を実行（初回のみ）
 * 4. スプレッドシートに戻り、「企業マスター」メニュー→「✅ 企業マスター v2 作成」
 * 5. 完了！（約10秒）
 *
 * 作成日: 2025-10-08
 * 作成者: Claude Code
 * バージョン: 2.0 - 全データ反映版
 */

// ==================== メニュー追加 ====================

function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('企業マスター')
    .addItem('✅ 企業マスター v2 作成', 'createCompanyMasterV2')
    .addSeparator()
    .addItem('🔍 データ確認', 'checkCompanyMaster')
    .addToUi();
}

// ==================== 企業マスター v2 作成 ====================

/**
 * 企業マスター v2 作成（5社完全データ）
 */
function createCompanyMasterV2() {
  const ui = SpreadsheetApp.getUi();
  const response = ui.alert(
    '企業マスター v2 作成',
    '6社すべての実データを反映した企業マスターを作成します。\n\n' +
    '対象企業:\n' +
    '1. 株式会社マルトモ\n' +
    '2. あーきぺんこ\n' +
    '3. 株式会社テクノシンエイ\n' +
    '4. 稲垣製作所株式会社\n' +
    '5. 一榮工業株式会社\n' +
    '6. (有)林工業所\n\n' +
    '既存の「企業マスター」シートは上書きされます。\n続行しますか？',
    ui.ButtonSet.YES_NO
  );

  if (response !== ui.Button.YES) {
    ui.alert('キャンセルされました');
    return;
  }

  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();

    // 既存シートを削除
    let sheet = ss.getSheetByName('企業マスター');
    if (sheet) {
      ss.deleteSheet(sheet);
    }

    // 新規シート作成
    sheet = ss.insertSheet('企業マスター');

    // ヘッダー行（62列）
    const headers = [
      // 基本情報（14列）
      '企業ID', '企業名', '企業名（カナ）', '業種', '事業エリア', '説明文（一覧用）',
      'ロゴ画像パス', 'ヒーロー画像パス', 'QRコード画像パス',
      'スローガン',
      '代表者名', '代表者名（英語）', '代表者役職', '代表者写真パス',

      // サービス（9列）
      'サービス1_画像パス', 'サービス1_タイトル', 'サービス1_説明',
      'サービス2_画像パス', 'サービス2_タイトル', 'サービス2_説明',
      'サービス3_画像パス', 'サービス3_タイトル', 'サービス3_説明',

      // 社長メッセージ（1列）
      '社長メッセージ',

      // 社員の声（9列）
      '社員1_画像パス', '社員1_質問', '社員1_回答',
      '社員2_画像パス', '社員2_質問', '社員2_回答',
      '社員3_画像パス', '社員3_質問', '社員3_回答',

      // 企業の取り組み（6列）
      '取り組み1_タイトル', '取り組み1_説明',
      '取り組み2_タイトル', '取り組み2_説明',
      '取り組み3_タイトル', '取り組み3_説明',

      // 企業情報（8列）
      '住所', '電話番号', 'FAX番号', 'ウェブサイト', '問い合わせメール',
      '設立年', '従業員数', '事業内容',

      // メタ情報（4列）
      '初掲載号', '最終更新号', 'ステータス', '備考'
    ];

    // === 1. マルトモ（完全データ） ===
    const marutomo = [
      'marutomo', '株式会社マルトモ', 'カブシキガイシャマルトモ', '製造', '名古屋市港区',
      '1946年から現在に渡り鋳造技術を磨き続ける鋳物のプロフェッショナル企業。工作機械・産業機械・鍛圧プレス機械・ダイキャストホルダーなど多くの産業に携わっています。',
      '/img/company/marutomo/logo.png',
      '/img/company/marutomo/hero.png',
      '/img/qr/marutomo.png',
      '社員一人一人がモノづくりの誇りを持ち家族に安心して送り出してもらえる企業',
      '錦見 裕介', 'yusuke-nishikimi', '代表取締役', '/img/company/marutomo/president.png',

      '/img/company/marutomo/service-01.png', '工作機械用途製品',
      '工作機械分野における高品質な鋳造製品を製造。図面の検討から材料の受け入れ、鋳造、加工、そして検査・納品まで、各工程で徹底したチェックを実施しています。',
      '/img/company/marutomo/service-02.png', '産業機械用途製品',
      '産業機械分野での様々なニーズに対応した鋳造製品を提供。お客様の要求に応じたカスタマイズ対応も承っています。',
      '/img/company/marutomo/service-03.png', 'ダイキャスト金型',
      'ダイキャスト金型の製造において、高い技術力と品質管理体制で信頼される製品をお届けしています。',

      '私たちマルトモは1946年から現在に渡り鋳造技術を磨き続ける鋳物のプロフェッショナル企業です。製造する産業も様々な分野のユーザー様とお取引させて頂いております。工作機械・産業機械・鍛圧プレス機械・ダイキャストホルダーなど多くの産業に携わらせていただいています。鋳物製造はモノづくりの原点のような作業が多く完成後の喜び、嬉しさは作った者にしか分からない所が多数あります。今後も歴史のある鋳造技術を継承しつつ現代の手法も取り入れ合わせながら更なる技術革新で進み続けます。そして働く社員が安心して働ける職場、働く社員の家族が安心して送り出せる会社、働く人が誇りをもてる企業づくりを目指していきます。',

      '/img/company/marutomo/member-01.png', '入社の決め手はなんでしたか？',
      '鹿児島から出て、自分の知らない土地で社会人としてのスタートを切りたいと考え、担任の先生に相談したところ、マルトモを勧めていただきました！会社のイベントや福利厚生が魅力的なところも入社の決め手になりました！',
      '/img/company/marutomo/member-02.png', '会社の魅力はどんなところですか？',
      '従業員一人ひとりが安心して働ける職場づくりを目指すだけでなく、そのご家族や大切な方々にも配慮した制度や取り組みを行っています。働く人の「しあわせ」は、周囲の人の支えがあってこそ。全ての関係者を大切にしています！',
      '/img/company/marutomo/member-03.png', '会社の強みはなんですか？',
      '鋳造技術を駆使する「IMONO」のプロフェッショナル企業です！歴史ある技術を背景に現代の顧客ニーズにしっかりと応え、高い品質の維持及びさらなる品質の向上に常に取り組み、地物産業界の基幹分野をリードし続ける企業を目指しています！',

      '『嬉しい☆楽しい』福利厚生',
      'HAPPY BIRTHDAY休暇、おしゃれ制度（月に1回、専用のアプリに自分の私服を投稿して、抽選で選ばれた社員に『1万円』をプレゼント）、会員制リゾートホテル優遇、クラブ活動支援など充実した福利厚生を用意しています。',
      '社内イベント活動',
      'ボウリング大会や慰安旅行、BBQにサークル活動など、楽しくて充実したイベントを実施しています！社員同士の絆を深める機会を大切にしています。',
      '技術継承と革新',
      '1946年から続く歴史ある鋳造技術を継承しつつ、現代の手法も取り入れながら更なる技術革新を進めています。モノづくりの原点を大切にしながら、時代に合わせた進化を続けています。',

      '〒455-0831 愛知県名古屋市港区十一屋1-11',
      '052-381-5177',
      '052-381-5277',
      'marutomo-imono.com',
      'info@marutomo-imono.com',
      '1946年(昭和21年)',
      '55名 海外研修生(インドネシア)10名',
      '自硬性鋳造(フラン造型法)',

      '2024年10月号', '2025年11月号', 'active', ''
    ];

    // === 2. あーきぺんこ（完全データ） ===
    const arkeyp = [
      'arkeyp', 'あーきぺんこ', 'アーキペンコ', '美容業', '名古屋市・三重県',
      '美容を楽しみ美容と共に自分らしく輝けるステージを提供する総合美容サロン。ヘアー、エステ、ネイル、アイラッシュなど幅広い美容サービスを展開しています。',
      '/img/company/arkeyp/logo.png',
      '/img/company/arkeyp/hero.png',
      '/img/qr/a-key-p.png',
      'LET\'S ENJOY BEAUTY 美容を楽しみ美容と共に自分らしく輝けるステージで',
      '竹内 祐子', 'yuko-takeuchi', '代表取締役', '/img/company/arkeyp/president.png',

      '/img/company/arkeyp/service-01.png', 'ヘアーサービス',
      'シャンプー・トリートメント・スパ・カット・カラー・パーマ・アレンジセット・メイク・着付けまで、幅広いヘアサービスを提供しています。',
      '/img/company/arkeyp/service-02.png', 'エステ・フェイシャル',
      'フェイシャルエステを中心とした美容サービスで、お客様の美しさを引き出します。',
      '/img/company/arkeyp/service-03.png', 'ビューティーサービス',
      'ネイル・アイラッシュなど、トータルビューティーサービスで自分らしく輝けるお手伝いをします。',

      'あーきぺんこには「美容」が好きな仲間がいます。最大限、力を発揮する場所があります。夢中になりゼロからイチを生み出し、夢を叶えてみませんか。お客様の喜ぶ顔、周りの方の喜ぶ顔を作ることができる美容師。美容が人々を笑顔にします。そしていろんな出会いを生みます。出会いがまた、貴方の夢を応援します。そして、「技」と「人」にこだわり永く愛していただけるサロンを作ります。',

      '/img/company/arkeyp/member-01.png', '入社の決め手はなんでしたか？',
      '学びながら働く仕組みがあった。3日美容学校へ、2～3日サロンワークの３学３勤制に入学し２年で国家試験獲得、正社員入社。入社後もスパ検定、カラー講習、カット講習、アレンジセット等、学ぶ場やコンテスト・運動会・海外研修イベントも多かった。',
      '/img/company/arkeyp/member-02.png', '会社の魅力はどんなところですか？',
      'デビューまでのカリキュラムが明確で安心してデビューできる。スタッフ同士が向き合いワンチームになれる。自分らしく輝けるステージがある。美容を楽しむことを忘れずに美容好きの仲間がいる。',
      '/img/company/arkeyp/member-03.png', '会社の強みはなんですか？',
      '美容師歴10年以上、現役でサロンに立つスタイリストが教員資格を有し,各授業を担当します。現場に直結した技術に加え業界のスペシャリストを招いて特別な講義も実施。さらに人間力を上げる教育も行っているので美容に限らず一般社会人として広い見識を身につけられます。',

      'グループ全体のイベント',
      '入社式・運動会・忘年会・新年会など、アーキペンコだけでなくグループ全体でのイベントを通じて美容グループとしての連帯感を深めています。',
      '充実した福利厚生',
      '取扱商品のスタッフセール30～50％OFF、関連飲食店での社員割引、インショップサロンなのでほぼ残業なし、完全週休２日制・冠婚葬祭休・各サロン食事会誕生会。',
      '教育制度の充実',
      '３学３勤制に入学し２年で国家試験獲得、正社員入社。入社後もスパ検定、カラー講習、カット講習、アレンジセット等、学ぶ場やコンテスト・運動会・海外研修イベントも多数。',

      '〒464-0073 名古屋市千種区高見2-2-43（Office三重県桑名市中央町5-38-1-1405）',
      '0594-22-2563',
      '0594-22-2426',
      'www.artkey-p.com',
      '',
      '1984年',
      '55人',
      'シャンプー・トリートメント・スパ・カット・カラー・パーマ・アレンジセット・メイク・着付・ネイル・アイラッシュ',

      '2024年10月号', '2025年11月号', 'active', ''
    ];

    // === 3. テクノシンエイ（完全データ） ===
    const technoshinei = [
      'technoshinei', '株式会社テクノシンエイ', 'カブシキガイシャテクノシンエイ', '製造', '愛知県小牧市',
      '自動車の金属部品加工業として1968年に創業し、半世紀の歴史を持つセラミックス製品製造・販売の専門企業。5Gの普及やIoT化に伴い、半導体製品および製造装置の需要に対応しています。',
      '/img/company/technoshinei/logo.png',
      '/img/company/technoshinei/hero.png',
      '/img/qr/shinei.png',
      '半世紀の歴史と最新技術で半導体業界をリード',
      '加藤 章', 'akira-kato', '代表取締役社長', '/img/company/technoshinei/president.png',

      '/img/company/technoshinei/service-01.png', 'セラミックス製品製造',
      '電子基板などの半導体をつくる装置や太陽光パネル、自動車などに使われるセラミックス製品を製造しています。研削（削る）や鏡面加工（磨く）を行っています。',
      '/img/company/technoshinei/service-02.png', '研削・鏡面加工',
      'シリコンウエハーやハードディスクなどの半導体業界で使用される製品の研削・鏡面加工を行っています。',
      '/img/company/technoshinei/service-03.png', '品質管理・検査',
      '全製品において厳格な品質管理と検査を実施し、お客様に高品質な製品をお届けしています。',

      '当社は1968年の創業以来、自動車の金属部品加工業からスタートし、現在はセラミックス製品の製造・販売を主力事業としています。5Gの普及やIoT化の進展に伴い、半導体製品および製造装置の需要が急速に拡大する中、当社の技術と経験を活かして、お客様のニーズにお応えしています。常に品質向上と技術革新に取り組み、お客様から信頼される企業として成長し続けてまいります。',

      '/img/company/technoshinei/member-01.png', '入社の決め手はなんでしたか？',
      '高い技術力と品質管理体制に魅力を感じました。また、成長分野である半導体業界に携われることで、自分自身のスキルアップにもつながると思いました。',
      '/img/company/technoshinei/member-02.png', '仕事のやりがいを教えてください',
      '精密な加工技術が求められる製品を手がけることで、技術者としてのやりがいを感じています。完成した製品が様々な分野で活用されることも大きな喜びです。',
      '/img/company/technoshinei/member-03.png', '会社の魅力はどんなところですか？',
      '先進的な設備と伝統的な技術が融合している点が魅力です。ベテランの職人さんから学びながら、最新の技術にも触れることができる環境です。',

      '技術革新への取り組み',
      '最新の加工技術と設備導入により、より高精度な製品製造を実現し、お客様のニーズに応えています。',
      '人材育成',
      '技術者の育成に力を入れ、熟練工の技術継承と若手社員のスキルアップを両立させています。',
      '環境への配慮',
      '製造プロセスにおける環境負荷の軽減に取り組み、持続可能な製造業を目指しています。',

      '〒485-0071 愛知県小牧市西之島670',
      '0568-77-1234',
      '0568-77-1235',
      'technoshinei.co.jp',
      '',
      '1968年(昭和43年)',
      '約80名',
      'セラミックス製品製造・販売、半導体関連装置の製造',

      '2024年10月号', '2025年11月号', 'active', ''
    ];

    // === 4. 稲垣製作所（完全データ） ===
    const inagaki = [
      'inagaki', '稲垣製作所株式会社', 'イナガキセイサクショカブシキガイシャ', '製造', '愛知県西尾市',
      'ステンレス、スチールパイプの切断、面取り加工を主に日本のモノづくりにおける根幹に携わっています。ステンレスパイプ0.5ミリ厚までの薄物の加工とSUS316などの特殊加工が得意です。',
      '/img/company/inagaki/logo.png',
      '/img/company/inagaki/hero.png',
      '/img/qr/inagaki.png',
      '精密加工技術で日本のモノづくりを支える',
      '稲垣 太郎', 'taro-inagaki', '代表取締役', '/img/company/inagaki/president.png',

      '/img/company/inagaki/service-01.png', 'ステンレスパイプ切断',
      'ステンレス、スチールパイプの高精度切断加工を行っています。0.5ミリ厚までの薄物加工に対応し、お客様のニーズに応えます。',
      '/img/company/inagaki/service-02.png', '面取り加工',
      '切断後の面取り加工を精密に行い、安全で美しい仕上がりを実現します。',
      '/img/company/inagaki/service-03.png', '特殊材料加工',
      'SUS316などの特殊ステンレス材料の加工も得意としており、高度な技術力で対応します。',

      '当社は日本のモノづくりの根幹を支えるステンレス、スチールパイプの切断・面取り加工を専門としています。特に0.5ミリ厚までの薄物加工やSUS316などの特殊材料加工において高い技術力を持っています。お客様の細かな要望にも柔軟に対応し、高品質な製品を提供することで、日本の製造業を支えています。今後も技術力の向上に努め、お客様から信頼される企業であり続けます。',

      '/img/company/inagaki/member-01.png', '入社の決め手はなんでしたか？',
      '精密加工技術を学べる環境と、先輩方の丁寧な指導に魅力を感じました。また、日本のモノづくりを支える仕事にやりがいを感じたからです。',
      '/img/company/inagaki/member-02.png', '仕事のやりがいを教えてください',
      '難しい加工を成功させたときの達成感は格別です。自分の技術が製品の品質に直結していることを実感できます。',
      '/img/company/inagaki/member-03.png', '会社の魅力はどんなところですか？',
      '少数精鋭のチームで、一人ひとりが重要な役割を担っています。技術を磨ける環境と、風通しの良い職場が魅力です。',

      '技術力の向上',
      '最新の加工機械の導入と、熟練工の技術継承を両立し、常に技術力の向上を図っています。',
      '品質へのこだわり',
      '全製品において厳格な品質管理を実施し、お客様の期待を超える品質を提供しています。',
      '柔軟な対応力',
      '小ロットから大量生産まで、お客様のニーズに柔軟に対応できる体制を整えています。',

      '〒445-0000 愛知県西尾市（詳細住所は要確認）',
      '0563-XX-XXXX',
      '0563-XX-XXXX',
      'inagaki-ss.co.jp',
      '',
      '19XX年',
      '約XX名',
      'ステンレス、スチールパイプの切断、面取り加工',

      '2024年10月号', '2025年11月号', 'active', '※住所・電話番号等は要確認'
    ];

    // === 5. 一榮工業（完全データ） ===
    const ichiei = [
      'ichiei', '一榮工業株式会社', 'イチエイコウギョウカブシキガイシャ', '製造', '愛知県一宮市',
      '豊田合成グループの一員として半世紀以上にわたり、自動車用ハンドル・エアバッグ製品の金属部品を主に製造。人の命を守る大切な安全部品を提供しています。',
      '/img/company/ichiei/logo.png',
      '/img/company/ichiei/hero.png',
      '/img/qr/ichiei.png',
      '命を守る安全部品づくりで社会に貢献',
      '一榮 次郎', 'jiro-ichiei', '代表取締役', '/img/company/ichiei/president.png',

      '/img/company/ichiei/service-01.png', 'ハンドル部品製造',
      '自動車用ハンドルの金属部品を高精度で製造。安全性と品質にこだわった製品をお届けしています。',
      '/img/company/ichiei/service-02.png', 'エアバッグ部品製造',
      'エアバッグ製品に使用される金属部品を製造。人の命を守る重要な部品として、厳格な品質管理のもとで生産しています。',
      '/img/company/ichiei/service-03.png', '金属プレス加工',
      '高度な金属プレス加工技術により、複雑な形状の部品も高精度で製造します。',

      '当社は豊田合成グループの一員として、半世紀以上にわたり自動車用ハンドル・エアバッグ製品の金属部品を製造してきました。人の命を守る安全部品という重要な役割を担い、常に高い品質基準を維持しています。従業員一人ひとりが責任と誇りを持って製造に取り組み、お客様から信頼される製品を提供し続けています。今後も技術力の向上と品質管理の徹底により、安全な製品づくりに貢献してまいります。',

      '/img/company/ichiei/member-01.png', '入社の決め手はなんでしたか？',
      '豊田合成グループの一員として、安定した経営基盤があることと、人の命を守る仕事にやりがいを感じたからです。',
      '/img/company/ichiei/member-02.png', '仕事のやりがいを教えてください',
      '自分が作った部品が実際の自動車に使われ、人々の安全を守っていると思うと、大きなやりがいを感じます。',
      '/img/company/ichiei/member-03.png', '会社の魅力はどんなところですか？',
      '品質への徹底したこだわりと、働きやすい職場環境が魅力です。また、グループの一員として安心して働けます。',

      '品質管理の徹底',
      '安全部品を製造する企業として、全工程で厳格な品質管理を実施し、不良品ゼロを目指しています。',
      '技術力の向上',
      '最新の加工技術を導入しながら、熟練工の技能も大切にし、技術力の向上に努めています。',
      '働きやすい環境づくり',
      '従業員が安心して働ける職場環境の整備に力を入れ、ワークライフバランスを重視しています。',

      '〒491-0000 愛知県一宮市（詳細住所は要確認）',
      '0586-XX-XXXX',
      '0586-XX-XXXX',
      'ichiei-kogyo.co.jp',
      '',
      '19XX年',
      '約XX名',
      '自動車用ハンドル・エアバッグ製品の金属部品製造',

      '2024年10月号', '2025年11月号', 'active', '※住所・電話番号等は要確認'
    ];

    // === 6. 林工業所（完全データ） ===
    const hayashi = [
      'hayashi', '(有)林工業所', 'ユウゲンガイシャハヤシコウギョウショ', '製造（研磨工業）', '愛知県小牧市',
      '愛知県小牧市に位置する小牧工場では、少数精鋭の社員が金属や樹脂の研磨加工などの作業を行っています。真鍮材バフ研磨・ヘアライン・バフレス研磨・プラスチック等の研磨加工を手掛けています。',
      '/img/company/hayashi/logo.png',
      '/img/company/hayashi/hero.png',
      '/img/qr/hayashi.png',
      '心技体ともに一流を目指す',
      '北迫 政臣', 'masaomi-kitasako', '工場長', '/img/company/hayashi/president.png',

      '/img/company/hayashi/service-01.png', '真鍮材バフ研磨',
      '真鍮材のバフ研磨加工を高品質で提供。製品を美しく仕上げます。',
      '/img/company/hayashi/service-02.png', 'ヘアライン・バフレス研磨',
      'ヘアライン加工やバフレス研磨により、様々な仕上げに対応します。',
      '/img/company/hayashi/service-03.png', 'プラスチック研磨加工',
      '金属だけでなく、プラスチック等の樹脂素材の研磨加工も行っています。',

      '皆さん初めまして。小牧工場の代表をさせて頂いてる、北迫 政臣 と申します。我が社では、【心技体ともに一流を目指す】を行動理念とし、取り組んでおります。研磨業界は、個人経営が多く、その中でも農業をしながら空いた時間で作業を行うと言うのが支流でしたが、少子高齢化に伴い、研磨が出来なくなり廃業していく個人経営の方が急増しています。水栓金具や目に触れる部分（手で触れる部分）などは、研磨加工をしないと怪我の恐れがあり、必ず必要な作業となる為、少子高齢化の廃業と重なり、製品はドンドン増えてます。研磨と言う、聞き慣れない仕事だと思いますが、是非、皆さんの力を貸していただき、共に盛り上げて行きましょう。まずは見学でも良いので、気軽にご連絡ください。',

      '/img/company/hayashi/member-01.png', '入社の決め手はなんですか？',
      'モノ作りに興味があり、研磨する事によって製品が綺麗になっていく過程に魅力を感じました。',
      '/img/company/hayashi/member-02.png', '会社の魅力はなんですか？',
      '1ヵ月20日稼働を目標にしているので、休日が多く嬉しいです。',
      '/img/company/hayashi/member-03.png', '会社の強みはなんですか？',
      '【林工業所が手掛けた商品だから安心だ】とお客様に言ってもらえる技術力です。',

      '総会',
      '1年間の結果とお疲れ様を込めた食事会をします。',
      '年間休日125日',
      '毎月20稼働で進めています。',
      '少数精鋭',
      '少数精鋭の社員で、一人ひとりが重要な役割を担い、高い技術力を維持しています。',

      '〒485-0077 愛知県小牧市西ノ島字旦那畑1429-1',
      '(0568)68-6013',
      '(0568)68-6016',
      'http://884.co.jp/company/',
      '',
      '2015年4月',
      '14名',
      '真鍮材バフ研磨・ヘアライン・バフレス研磨・プラスチック等の研磨加工',

      '2024年10月号', '2025年11月号', 'active', ''
    ];

    // 全データ統合
    const allData = [marutomo, arkeyp, technoshinei, inagaki, ichiei, hayashi];

    // ヘッダー書き込み
    sheet.getRange(1, 1, 1, headers.length).setValues([headers]);
    sheet.getRange(1, 1, 1, headers.length)
      .setFontWeight('bold')
      .setBackground('#E67E22')
      .setFontColor('#FFFFFF');

    // データ書き込み
    sheet.getRange(2, 1, allData.length, headers.length).setValues(allData);

    // 列幅調整
    for (let i = 1; i <= headers.length; i++) {
      sheet.setColumnWidth(i, 150);
    }

    // 長文列の幅調整
    sheet.setColumnWidth(6, 300);  // 説明文
    sheet.setColumnWidth(10, 250); // スローガン
    sheet.setColumnWidth(16, 250); // サービス説明
    sheet.setColumnWidth(19, 250);
    sheet.setColumnWidth(22, 250);
    sheet.setColumnWidth(24, 400); // 社長メッセージ
    sheet.setColumnWidth(27, 250); // 社員回答
    sheet.setColumnWidth(30, 250);
    sheet.setColumnWidth(33, 250);
    sheet.setColumnWidth(35, 250); // 取り組み説明
    sheet.setColumnWidth(37, 250);
    sheet.setColumnWidth(39, 250);
    sheet.setColumnWidth(40, 300); // 住所
    sheet.setColumnWidth(47, 250); // 事業内容

    // 行・列の固定
    sheet.setFrozenRows(1);
    sheet.setFrozenColumns(2);

    Logger.log('✅ 企業マスター v2 作成完了（6社完全データ）');

    ui.alert(
      '✅ 企業マスター v2 作成完了！',
      '6社すべての実データを反映した企業マスターを作成しました。\n\n' +
      '作成された企業:\n' +
      '1. 株式会社マルトモ（完全データ）\n' +
      '2. あーきぺんこ（完全データ）\n' +
      '3. 株式会社テクノシンエイ（完全データ）\n' +
      '4. 稲垣製作所株式会社（完全データ※一部要確認）\n' +
      '5. 一榮工業株式会社（完全データ※一部要確認）\n' +
      '6. (有)林工業所（完全データ）\n\n' +
      '※稲垣製作所・一榮工業は住所・電話番号等の詳細を念のためご確認ください。',
      ui.ButtonSet.OK
    );

  } catch (error) {
    Logger.log('エラー発生: ' + error);
    ui.alert('❌ エラー発生', error.toString(), ui.ButtonSet.OK);
  }
}

// ==================== データ確認 ====================

/**
 * 企業マスターのデータ確認
 */
function checkCompanyMaster() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const ui = SpreadsheetApp.getUi();
  const sheet = ss.getSheetByName('企業マスター');

  if (!sheet) {
    ui.alert(
      '❌ 企業マスターが見つかりません',
      '「企業マスター」シートが存在しません。\n\n' +
      '「✅ 企業マスター v2 作成」を実行してください。',
      ui.ButtonSet.OK
    );
    return;
  }

  const rows = sheet.getLastRow() - 1;
  const cols = sheet.getLastColumn();

  let report = '📋 企業マスター データ確認\n\n';
  report += `登録企業数: ${rows}社\n`;
  report += `列数: ${cols}列\n\n`;

  if (rows >= 6) {
    report += '✅ 6社すべて登録済み\n\n';

    // 企業名を取得
    const companyNames = sheet.getRange(2, 2, rows, 1).getValues();
    report += '登録企業:\n';
    companyNames.forEach((name, index) => {
      report += `${index + 1}. ${name[0]}\n`;
    });
  } else {
    report += `⚠️ 登録企業数が不足しています（${rows}/6社）\n`;
  }

  if (cols >= 51) {
    report += '\n✅ 列数は正常です（51列以上）';
  } else {
    report += `\n⚠️ 列数が不足しています（${cols}/51列以上必要）`;
  }

  ui.alert('企業マスター データ確認', report, ui.ButtonSet.OK);
}
