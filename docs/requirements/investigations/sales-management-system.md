# sales-management-system 調査結果

**調査日**: 2025-10-04
**パス**: `/mnt/c/sales-management-system`
**サイズ**: 0.16 MB
**最終更新**: 2025-10-01

---

## 📋 基本情報

### ディレクトリ構造

```
/mnt/c/sales-management-system/
├── createSalesManagementSheet.gs              # メインスクリプト (31.9 KB)
├── addKpiFormulas.gs                          # KPI数式追加スクリプト (2.7 KB)
├── createDailyProgressDashboard.gs            # 日次進捗ダッシュボード作成 (17.7 KB)
├── README.md                                  # セットアップガイド (6.4 KB)
├── プロジェクト引き継ぎドキュメント.md          # プロジェクト詳細説明 (14.7 KB)
├── KPIダッシュボード改善_引き継ぎ資料.md       # KPIダッシュボード改善仕様 (9.3 KB)
├── 数式配置ドキュメント.md                     # 数式詳細 (11.9 KB)
├── 数式配置ドキュメント_v2.md                  # 数式詳細 v2 (9.7 KB)
├── 数式配置ドキュメント_v3.md                  # 数式詳細 v3 (11.1 KB)
├── 数式追加マニュアル.md                       # 数式追加マニュアル (13.3 KB)
├── 月次予実管理_数式一覧.md                    # 月次予実管理の数式 (13.2 KB)
└── 年度対応_修正数式一覧.md                    # 年度対応修正版 (13.2 KB)
└── 年度対応_修正数式_完全版.md                 # 年度対応完全版 (13.5 KB)
```

**ファイル総数**: 13ファイル（全てドキュメント・スクリプト）

---

## 🛠️ 技術スタック

### プラットフォーム
- **Google Apps Script (GAS)** - Googleスプレッドシート用スクリプト
- **Google Sheets** - スプレッドシート本体（外部）

### 言語
- **JavaScript (Google Apps Script)** - `.gs`ファイル
- **Markdown** - ドキュメント

### 特徴
- コードリポジトリではなく、**Google Apps Scriptのソースコード + ドキュメント集**
- 実際のスプレッドシートは別途Google Drive上に存在（このディレクトリにはない）
- スクリプトをコピー&ペーストしてスプレッドシートに組み込む方式

---

## 📊 既存機能

### システム概要
**営業管理スプレッドシートシステム** - Google Sheetsベースの営業活動管理ツール

### 作成されるシート構成

#### 1. 日報シート
- 日々の営業活動数値を記録
- テレアポ件数、商談件数、対面商談、オンライン商談、契約数
- シンプルな数値入力のみ

#### 2. 顧客マスタシート
- 顧客ごとの営業活動履歴を詳細管理
- 基本情報（会社名、担当者、連絡先）
- 商談活動（テレアポ、オンライン商談、対面商談）
- 使用ツール（営業資料、HP、雑誌現物、雑誌HP）
- クロージング、ネクストアクション
- 最終結果（受注/お断り）
- ドロップダウンによる入力補助
- 色分けによる視覚的整理

#### 3. 獲得率設定マスタシート
- アポ獲得率、商談率、契約率を設定
- 月次予実管理の逆算計算に使用される転換率を管理

#### 4. サービス・料金設定マスタシート
- 契約サービスと料金（月額・一括）を管理
- ゆめスタパートナー: 月額10,000円
- ゆめマガ: 月額150,000円 / 一括960,000円

#### 5. 入金サイト設定マスタシート
- 入金サイト（末締め翌月末払い等）を管理
- 契約日から入金予定日を自動計算するルール

#### 6. 月次予実管理シート
- 月別の目標と実績を管理
- **逆算ロジック**: 契約件数目標から必要な商談数・アポ数・テレアポ数を自動算出
- 売上目標・実績・達成率
- 入金予定額・実績・入金率

#### 7. 契約・入金管理シート
- 契約後の書類管理と入金管理
- 契約書・申込書の送付/回収日管理
- 入金予定日・実績日・遅延日数の自動計算
- 入金ステータス自動判定（入金済/未入金/遅延）
- 企業名自動取得（顧客マスタから受注企業をFILTER）

#### 8. KPIダッシュボードシート
- 全体のKPIを一覧表示
- **KGI**: 契約件数、売上金額
- **KPI**: テレアポ件数、アポ獲得数・率、商談件数・率、受注件数、契約率
- **ツール別効果分析**: 各営業ツールの使用回数・受注数・受注率
- 対象月選択機能（改善実装中）

### 主要な自動化機能

#### データ自動集計
- テレアポ件数、商談件数、受注件数の自動カウント
- 転換率（アポ獲得率、商談率、契約率）の自動計算
- 月別実績の自動集計

#### 逆算ロジック
- 契約件数目標を入力すると、必要な行動量を自動算出
  - 必要商談件数 = 契約件数目標 ÷ 契約率
  - 必要アポ件数 = 必要商談件数 ÷ 商談率
  - 必要テレアポ件数 = 必要アポ件数 ÷ アポ獲得率

#### 入金管理
- 入金予定日の自動計算（契約日 + 入金サイト）
- 入金ステータスの自動判定
- 遅延日数の自動計算

#### 可視化
- 条件付き書式による色分け
  - 達成率（100%以上=緑、80-99%=黄、80%未満=赤）
  - 最終結果（受注=緑、お断り=赤）
  - 入金ステータス（入金済=緑、未入金=黄、遅延=赤）

---

## 🎯 設計思想・原則

### 1. 入力は最小限、得られる情報は最大限
- 営業担当者の入力負荷を減らす
- 自動集計・自動計算で分析データを生成

### 2. 逆算思考の実装
- 最終目標（契約件数）から必要な行動量を逆算
- KPIの転換率を元に必要なテレアポ件数などを自動算出

### 3. 視覚的にわかりやすく
- 色分けによる情報の整理
- 条件付き書式で進捗状況を可視化

### 4. Google Sheetsネイティブ
- FILTER関数、ARRAYFORMULA、COUNTIFS等のGoogle Sheets専用関数を活用
- Excel互換ではない（Google Sheets専用設計）

---

## 💼 利用状況（ユーザーヒアリング結果）

### 現在の状態
- **使用状況**: ✅ 稼働中・毎日使用
- **使用者**: 営業メンバー + マネージャー（ユーザー本人のみ）
- **満足度**: 課題なし・機能的に完成済み
- **データ規模**:
  - 顧客マスタ: 約100社
  - 月間契約目標: 5件～

### 開発履歴
- **2025-09-30**: プロジェクト開始・初期バージョン完成
- **2025-09-30～10-01**: 数式改善、年度対応、KPIダッシュボード改善
- **2025-10-01**: 最終更新

### 使用目的
- ゆめスタの営業活動管理
- ゆめマガ・ゆめスタパートナーの契約管理
- 営業チームのKPI管理・進捗管理

---

## 🔗 統合ダッシュボードとの関係性

### 重複する機能領域

#### 営業管理機能
- **sales-management-system**: Google Sheets + GASで実装済み
- **統合ダッシュボード（予定）**: 営業進捗管理機能を含む予定

#### データ管理
- **sales-management-system**: 顧客マスタ、契約・入金管理をスプレッドシートで管理
- **統合ダッシュボード（予定）**: データ統合機能で既存スプレッドシートと連携予定

#### KPI管理
- **sales-management-system**: KPIダッシュボードで可視化
- **統合ダッシュボード（予定）**: プロジェクトマネジメント機能にKPI管理を含む予定

### 連携シナリオ

#### ビジネス戦略メモより
- 「ゆめマガディレクトリ」内に営業進捗管理スプレッドシートが存在
- 統合ダッシュボードは「スプレッドシート（営業進捗管理）」と連携予定

### 統合可否の検討

#### オプション1: 独立運用を継続
- **メリット**:
  - 既に完成済み・稼働中の可能性が高い
  - Google Sheetsの使い慣れたUIで運用可能
  - すぐに使い始められる
- **デメリット**:
  - 統合ダッシュボードと機能が重複
  - データが分散
  - 他の業務（ゆめマガ制作、Instagram運用等）との連携が困難

#### オプション2: 統合ダッシュボードに統合
- **メリット**:
  - 全業務を一元管理可能
  - 営業管理とゆめマガ制作・学校配布等の連動が可能
  - データの一元化
  - より高度な分析・レポート機能を実装可能
- **デメリット**:
  - 移行コストが発生
  - 既存の使い慣れたスプレッドシートUIから変更が必要
  - 統合ダッシュボード開発に時間がかかる

#### オプション3: 段階的統合
- **フェーズ1**: sales-management-systemを独立運用継続
- **フェーズ2**: 統合ダッシュボードから営業管理スプレッドシートをAPI連携で参照
- **フェーズ3**: 統合ダッシュボードに営業管理機能を実装し、段階的に移行
- **メリット**:
  - すぐに運用開始可能
  - 段階的に統合できる
  - リスクが低い
- **デメリット**:
  - 移行期間が長くなる
  - 二重管理の期間が発生

---

## 📝 技術的な特記事項

### Google Apps Script実装の特徴

#### シート作成方式
```javascript
function createOrUpdateXXXSheet(ss)
```
- 既存シートがあれば内容をクリアして更新
- 既存シートがなければ新規作成
- **削除処理は一切なし**（エラー回避のため）

#### ARRAYFORMULA活用
- 1つの数式で列全体を一括計算
- 契約金額自動計算、入金ステータス自動判定等で使用

#### FILTER関数活用
- 顧客マスタから受注企業のみを抽出
- Google Sheets専用関数（Excelでは動作しない）

### 制約・注意点

#### Google Sheets専用
- FILTER関数、ARRAYFORMULA等はExcelでは動作しない
- Google Drive環境必須

#### 年度対応
- 月次予実管理で `YEAR(TODAY())` を使用
- 年度をまたぐ場合は数式の調整が必要（将来課題）

#### 転換率依存
- KPIダッシュボードの転換率が0の場合、月次予実管理の逆算がエラー
- 初期値として想定転換率を手動入力する必要あり

---

## 🤔 統合可否の判断材料

### 技術的観点

#### 統合が容易な点
- Google Sheets API経由でデータ取得可能
- スプレッドシートの構造が明確（8シート構成）
- 数式ロジックがドキュメント化されている

#### 統合が困難な点
- Google Sheets固有機能（FILTER、ARRAYFORMULA）への依存
- リアルタイム更新・条件付き書式等のスプレッドシート機能
- ユーザーが使い慣れたスプレッドシートUI

### 業務的観点

#### 現在の利用状況が不明
- 実際に運用されているか？
- ユーザーの使用頻度・満足度は？
- 他のメンバーも使用しているか？

#### データ量・規模
- 顧客数、契約数の規模は？
- パフォーマンス上の課題はあるか？

---

## ✅ ユーザー確認結果（2025-10-04）

### 利用状況について

1. **現在の使用状況**
   - ✅ 毎日使用している
   - ✅ 営業メンバーも使用している
   - ✅ マネージャーはユーザー本人のみ

2. **満足度・課題**
   - ✅ このシステム自体に課題はない
   - ✅ 機能的に満足している

3. **データ規模**
   - ✅ 顧客マスタ: 約100社
   - ✅ 月間契約目標: 5件～
   - ✅ パフォーマンス問題なし

### 統合方針について

4. **統合ダッシュボードとの関係**
   - ✅ **このシステムは当然マネジメントダッシュボードに必要**
   - ✅ 統合必須と判断

5. **優先順位**
   - ✅ 統合ダッシュボードの必須機能として扱う

6. **移行方針**
   - 要検討: 段階的統合 vs 完全統合

---

## 💡 統合アプローチ（ユーザー確認済み）

### ユーザー要望
- ✅ **営業管理機能は統合ダッシュボードに必須**
- ✅ 現在のシステムは毎日使用・課題なし
- ✅ 営業メンバーも使用中

### 推奨アプローチ: 段階的統合

#### Phase 1: API連携（短期・MVP）
**目的**: 現在の運用を止めずに、統合ダッシュボードで営業データを可視化

- 統合ダッシュボードから**Google Sheets APIで営業管理スプレッドシートを参照**
- KPI数値・契約状況を統合ダッシュボードにも表示（読み取り専用）
- **入力は引き続きGoogle Sheetsで実施**（営業メンバーの作業は変わらない）
- 統合ダッシュボードでは「営業KPI」「契約状況」「入金管理」を他業務と並べて表示

**メリット**:
- 現在の運用を止めない
- 営業メンバーの作業負荷ゼロ
- 統合ダッシュボードで全業務（営業・ゆめマガ制作・SNS等）を一覧可能
- 開発コストが低い

**デメリット**:
- Google Sheetsへの依存が残る
- 統合ダッシュボード側からの編集は不可

#### Phase 2: データ同期（中期）
**目的**: 統合ダッシュボード側でも営業データを編集可能に

- 統合ダッシュボードに営業管理機能を実装
- Google Sheetsと**双方向同期**
- 営業メンバーは引き続きGoogle Sheetsで入力可能
- マネージャーは統合ダッシュボードで管理可能

**メリット**:
- どちらからでも編集可能
- 段階的な移行が可能

**デメリット**:
- 同期ロジックの実装が複雑

#### Phase 3: 完全統合（長期）
**目的**: 統合ダッシュボードに一本化

- 統合ダッシュボードに営業管理機能を完全実装
- Google Sheetsから完全移行
- 営業メンバーも統合ダッシュボードで入力

**メリット**:
- 完全な一元管理
- より高度な機能実装が可能

**デメリット**:
- 営業メンバーのUI変更（慣れが必要）
- 開発コストが高い

### 最終推奨: Phase 1でスタート

**理由**:
1. 現在のシステムは毎日使用・課題なし → 急いで移行する必要はない
2. 営業メンバーも使用中 → UI変更は慎重に
3. 統合ダッシュボードのMVPでは「全業務の可視化」が最優先
4. API連携であれば開発コストが低く、リスクも最小

**MVP範囲**: 営業KPI・契約状況・入金管理の**表示のみ**（読み取り専用）

---

## 📊 次のアクション

### 調査完了後のタスク
- [x] ユーザーに調査結果を報告
- [x] 現在の利用状況をヒアリング
- [x] 統合方針をユーザーと合意
- [ ] 要件定義書に反映

### 要件定義への影響

#### 確定事項
- ✅ 営業管理機能は統合ダッシュボードの**必須機能**
- ✅ MVP範囲: 営業KPI・契約状況・入金管理の**表示**（Google Sheets API連携）
- ✅ 入力はGoogle Sheetsで継続（営業メンバーの作業は変わらない）

#### データ連携仕様
- Google Sheets API経由でデータ取得
- 連携対象シート:
  - 顧客マスタ
  - 契約・入金管理
  - KPIダッシュボード
  - 月次予実管理
- 更新頻度: リアルタイム or 定期同期（要検討）

#### 今後の検討事項
- Google Sheets APIの認証方式
- データ同期の仕様
- 統合ダッシュボードでの表示UI

---

**調査者**: Claude Code
**調査日**: 2025-10-04
**ステータス**: ✅ 調査完了・ユーザー確認済み
