# ゆめマガディレクトリ 調査結果（Phase4版 - 修正完了）

**調査日**: 2025-10-04
**修正日**: 2025-10-04
**パス**: `/mnt/c/ゆめマガ`
**サイズ**: 1.17 GB
**最終更新**: 2025-10-01

**調査ステータス**: ✅ Phase4の正確な構成を把握完了

---

## ⚠️ 重要な訂正

### Phase1からPhase4への修正
- **旧調査**: Phase1の古いバージョン（基本的な工程管理）
- **実際**: Phase4の逆算スケジューラー（高度な制約管理・逆算配置）
- **データソース**: `/mnt/c/ゆめマガ/動的月号対応/` ディレクトリ

---

## 📋 基本情報（Phase4版）

### ディレクトリ構造

```
/mnt/c/ゆめマガ/ (1.2 GB)
├── .git/                                 (596 MB)
├── 素材/                                  (256 MB)
├── 202506/                               (151 MB) - 6月号データ
├── 202508/                               (135 MB) - 8月号データ
├── 202510/                               (54 MB)  - 10月号データ
├── 202511_サンプル/                       (8 KB)   - サンプルデータ
├── ui/                                   (4.9 MB) - UIデザイン
├── 動的月号対応/                          (460 KB) - 月号対応GAS（アーカイブ含む）
├── Phase1_成果物/                        (376 KB) - 工程管理関連CSV・分析
├── Phase2_完成版_2025年10月号/            (36 KB)  - 完成版GAS・CSV
├── Phase2_成果物/                        (0)
├── Phase3_成果物/                        (0)
├── Phase4_成果物/                        (0)
├── 00_テンプレート/                      (12 KB)  - 各種テンプレート
├── 01_企画管理/                          (4 KB)
├── 02_素材ライブラリ/                    (0)
├── 03_制作ガイドライン/                  (12 KB)
├── 04_進行管理/                          (28 KB)  - マスタースケジュール
├── QR/                                   (0)
└── 各種ドキュメント（Markdown）          (多数)
```

**主要ディレクトリ**:
- 月号別データ（202506, 202508, 202510）: PDFファイル・素材
- 工程管理関連（Phase1〜4）: GAS・CSV・分析ドキュメント
- 素材ライブラリ: 256 MB（画像・素材）

---

## 🔍 GASによって作成されたスプレッドシート（Phase4版・最重要）

### スプレッドシート: ゆめマガ工程管理システム（逆算スケジューラー）

**作成元**: `/mnt/c/ゆめマガ/動的月号対応/` のGoogle Apps Script（Phase4）
**GASファイル構成**:
1. `Phase4_理想形スケジューラー.js` - メインロジック
2. `Phase4_修正版実行関数.js` - 実行関数
3. `Phase4_マスターデータ読み取り関数.js` - データ読み取り

#### Phase4の特徴: 逆算スケジューラー
**従来（Phase1）**: 開始日から順算で配置
**Phase4**: 校了日（Z-3: 28日目）から逆算で配置

#### マスターデータ構成（7ファイル）

##### 1. 新工程マスターV2.csv
**列構成**:
- 工程No
- 工程名
- 工数
- 担当区分（インタビュワー・撮影陣 / 制作陣 / 外部依頼）
- 優先度（クリティカル / 高 / 中）
- 必要データ
- 確定締切
- 期間指定
- 作業カテゴリ

**工程数**: 97工程（従来72工程から拡張）

**主要工程カテゴリ**:
- 文字起こし（A-3, K-3, L-5, M-5, H-3, I-3）
- 内容整理（A-4, K-4, L-6, M-6, H-4, I-4）
- レタッチ（A-6, L-7, M-7, H-6, I-6, C-5）
- ページ制作（A-12, K-5, L-8, M-8, H-7, I-7, C-6, J-1）
- 内部チェック（A-13, K-6, L-9, M-9, H-8, I-8, C-7, E-3, P-3）
- 確認送付（A-14, A-15, K-7, L-10, M-10, H-9, I-9, C-8, E-4, P-4）

##### 2. 逆算依存関係マスター.csv
**Phase4の核心機能**

**列構成**:
- 工程No
- 前提工程
- 依存タイプ（「開始前」「同日可」「7日より前」）
- 日数

**重要な逆算制約**:
- **B-1 → 内部チェック系工程**: 全内部チェック（A-13, K-6, L-9, M-9, H-8, I-8, C-7, E-3, P-3）がB-1開始前に完了必須
- **Z-1 → 確認送付系工程**: 全確認送付が「7日より前」に完了必須（外部回答待ち期間）
- **逆算の流れ**: Z-3（校了日: 28日目） → Z-2（最終チェック） → Z-1（全ページ完成: 25日目） → 確認送付完了（18日目以前） → 内部チェック完了 → ページ制作完了

##### 3. 設定マスター.csv
**制作サイクル設定**:
- 対象年: 2025
- 対象月号: 11（可変）
- 制作サイクル: **60日間**（従来30日 → Phase4で60日に拡張）
- 開始日: 対象月の2ヶ月前21日
- 締切日: 対象月の20日

##### 4. カレンダーマスター.csv
**営業日計算用**:
- 土日祝日の判定
- 作業可能日の計算

##### 5. カテゴリ同期マスター.csv
**同一カテゴリ工程の同期配置**:
- 同じ作業カテゴリ（文字起こし、レタッチ等）を同日配置
- 担当者の作業効率化

##### 6. 負荷制約マスター.csv
**担当者の同時作業制限**:
- 制作陣の負荷分散
- ページ制作工程の分散配置

##### 7. 期間制約マスター.csv
**特定期間の制約定義**:
- 新規企業追加可能期間（C-9: 1-13日目）
- 既存企業修正変更対応可能期間（E-5, P-5: 1-17日目）
- 全体修正対応期間（N-1: 21-26日目）

#### スプレッドシート出力（自動生成）

##### スケジュールシート
**列構成**:
- 工程No
- 工程名
- 開始予定日（逆算で自動計算）
- 完了予定日（逆算で自動計算）
- 実際開始日（手入力）
- 実際完了日（手入力）
- ステータス（未開始/進行中/完了）
- 遅延日数（自動計算）
- 担当区分

**逆算計算ロジック**:
1. Z-3（校了日: 28日目）を起点
2. 逆算依存関係マスターに基づく逆算配置
3. 外部依存期間（7日間の回答待ち）の考慮
4. 土日祝日のスキップ
5. 負荷制約・期間制約の適用

##### ガントチャートシート
**構成**:
- A列: 工程名
- B列〜列: 日付列（60日間分）
- 条件付き書式: 担当区分別色分け
  - インタビュワー・撮影陣: 緑系
  - 制作陣: 青系
  - 外部依頼: 橙系

**表示ルール**:
- 作業期間中のセルに工程Noを表示
- 作業期間外は空白

---

### 営業進捗管理スプレッドシート

**作成元**: `/mnt/c/sales-management-system`（Google Apps Script）

**詳細**: 既に調査完了（`docs/requirements/investigations/sales-management-system.md`参照）

**統合方針**: Google Sheets API連携（読み取り専用）

---

## 📊 Phase4工程管理システムの特徴

### 担当者別分類

#### 🟢 インタビュワー・撮影陣
- **役割**: 外部調整・取材・撮影・外部依頼管理
- **締切管理**: 外部依存案件の進捗管理
- **主な業務**:
  - 実施日報告
  - データ提出（写真・録音データ）
  - 撮影
  - 外部依頼・リマインド

#### 🔵 制作陣
- **役割**: コンテンツ制作・品質管理・ページ制作
- **工数管理**: 制作品質の確保
- **主な業務**:
  - 文字起こし・内容整理
  - 写真レタッチ・ページ制作
  - チェック・キャッチコピー作成
  - 目次作成・最終チェック

#### 🟡 外部依頼
- **対象**: 表紙加工のみ
- **管理**: 依頼業務の進捗管理

### Phase4の逆算スケジュール管理ルール

#### 基本ルール
- **制作サイクル**: 60日間（従来30日から拡張）
- **締切起点**: 校了日（Z-3: 28日目）から逆算
- **回答待ち期間**: 7日間（確認送付 → Z-1全ページ完成）
- **内部チェック**: 確認送付の前に1日必須
- **最終チェック**: Z-2（26-27日目）固定・3日間

#### 逆算スケジュールの流れ
1. **Z-3（校了日）**: 28日目（固定）
2. **Z-2（最終チェック）**: 26-27日目（3日間）
3. **Z-1（全ページ完成）**: 25日目
4. **確認送付完了**: 18日目以前（Z-1の7日前）
5. **B-1（全企画タイトル確定）**: 8日目（Z-1の17日前）
6. **内部チェック系完了**: B-1開始前（7日目以前）
7. **ページ制作完了**: 内部チェック前

#### 制約管理
**期間制約**:
- 新規企業追加可能期間: 1-13日目
- 既存企業修正変更対応可能期間: 1-17日目
- 全体修正対応期間: 21-26日目（新規案件絶対厳禁）

**負荷制約**:
- 制作陣の同時作業数制限
- ページ制作工程の分散配置

**カテゴリ同期**:
- 同一カテゴリ工程を同日配置（作業効率化）

#### 外部依存管理（重要）
**7日間の回答待ち期間を考慮**:
- 確認送付（A-14, A-15, K-7, L-10, M-10, H-9, I-9, C-8, E-4, P-4）
- すべて「Z-1の7日より前」に完了必須
- 外部依存先: 企業5社、インタビュー対象者4名、学校1校、表紙加工（合計11個）

---

## 💡 統合ダッシュボードとの関係性

### ビジネス戦略メモとの対応

#### 記載内容
> **ゆめマガディレクトリ** (1.17 GB)
> - 実際のゆめスタの内容（PDF・画像）
> - サイトのパートナー一覧と連動
> - サイトのスター紹介と連動
> - 企画内容と連動
> - **情報誌作成工程管理（スプレッドシート）**
> - **営業進捗管理（スプレッドシート）**

#### 対応関係
- ✅ **情報誌作成工程管理スプレッドシート**: 本調査で特定完了
- ✅ **営業進捗管理スプレッドシート**: Phase 1-1で調査済み
- ⬜ パートナー一覧との連動: 次回調査（Step 2）
- ⬜ スター紹介との連動: 次回調査（Step 2）
- ⬜ PDF・画像: 次回調査（Step 2）

---

## 🎯 統合ダッシュボードへの統合方針（Phase4版）

### MVP範囲（Phase 1）

#### 必須機能
1. **ゆめマガ制作進捗管理（Phase4逆算スケジューラー）**
   - Google Sheets API連携（Phase4スプレッドシート）
   - スケジュールシートの表示
     - 工程No・工程名
     - 開始予定日・完了予定日（逆算で自動計算）
     - 実際開始日・実際完了日
     - ステータス（未開始/進行中/完了）
     - 遅延日数（自動計算）
     - 担当区分
   - ガントチャートの表示（60日間・担当区分別色分け）
   - 外部依存工程のハイライト表示（回答待ち期間の可視化）

2. **営業進捗管理**
   - Google Sheets API連携（営業進捗管理スプレッドシート）
   - KPI表示（Phase 1-1調査済み）

#### 連携仕様（Phase4版）
- **API**: Google Sheets API
- **認証**: サービスアカウント or OAuth 2.0
- **更新頻度**: リアルタイム or 定期同期（要検討）

**連携対象スプレッドシート（2つ）**:
1. **Phase4逆算スケジューラー**:
   - スプレッドシートID: `1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw`
   - 用途: ゆめマガ制作進捗管理（工程管理・ガントチャート）
   - 注意事項: 月号ごとにスプレッドシートが変わる（ダッシュボード用の専用シート作成を検討）

2. **パートナー企業・スター紹介データ**:
   - スプレッドシートID: `12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc`
   - 用途: インタビュー内容の回答収集・管理
   - 連携先: ゆめマガPDF（CANVA）、yumesutaHP（STAR紹介・パートナー一覧・企業ページ）

- **表示形式**:
  - ダッシュボード上でガントチャート表示
  - 逆算スケジュールの可視化
  - 制約違反のアラート表示（校了日後配置の検出）
  - パートナー企業・スター紹介データの一覧表示

#### Phase4特有の表示要件
- **逆算スケジュールの強調**: 校了日（Z-3）を起点とした逆算配置の可視化
- **制約管理の可視化**:
  - 期間制約（新規企業追加可能期間等）
  - 負荷制約（制作陣の同時作業数）
  - カテゴリ同期（同一カテゴリ工程の同日配置）
- **外部依存リスクの監視**: 7日間の回答待ち期間の進捗管理

---

## 📝 次のステップ（Phase4調査完了後）

### Step 2: PDF構造・パートナー企業データ確認 ✅ 完了
**調査内容**:
- [x] PDF配置場所の確認（202506, 202508, 202510ディレクトリ）
- [x] PDF命名規則の確認
- [x] パートナー企業データの形式・場所確認
- [x] スター紹介データの形式・場所確認

**調査結果**:

#### 1. PDF配置場所・命名規則
**配置場所**: 月号別ディレクトリ（`202506/`, `202508/`, `202510/`）

**命名規則**:
- `202506/`: `マガ 6月号.pdf` (143MB), `マガ+6月号-圧縮.pdf` (8.2MB)
- `202508/`: `ゆめマガ　8月号 (3).pdf` (132MB), `ゆめマガ　8月号 (3)-compressed.pdf` (3.9MB)
- `202510/`: PNG画像ファイル（1.png〜32.png、計32ページ分、計54MB）

**特徴**:
- PDF形式 または PNG画像形式
- 圧縮版を併用（容量削減）
- 月号ごとに命名規則が若干異なる

#### 2. パートナー企業データ・スター紹介データ
**制作ツール**: CANVA（全てのページをCANVAで作成）

**データ管理**:
- **スプレッドシート**: https://docs.google.com/spreadsheets/d/12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc/edit?resourcekey=&gid=1761216897#gid=1761216897
- **スプレッドシートID**: `12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc`
- **用途**: インタビュー内容の回答を収集

**HP連携**:
- **yumesutaHP STAR紹介ページ**: 同じ内容を掲載
- **ゆめスタパートナー一覧**: 同じ内容を掲載
- **企業ページ**: 同じ内容を掲載

**データの流れ**:
```
スプレッドシート（インタビュー回答収集）
  ↓
CANVA（ゆめマガPDF作成）
  ↓
yumesutaHP（STAR紹介・パートナー一覧・企業ページ）
```

**重要な発見**:
- パートナー企業・スター紹介データは、スプレッドシートで一元管理
- ゆめマガPDFとyumesutaHPは同じデータソースを共有
- 統合ダッシュボードでこのスプレッドシートを連携すれば、ゆめマガ・HP両方のコンテンツを管理可能

### Step 3: 詳細データ構造確認 ✅ 完了
**調査内容**:
- [x] 素材ディレクトリの構造確認（256 MB）
- [x] 月号別ディレクトリの詳細確認
- [x] テンプレート・ガイドラインの確認

**調査結果**:

#### 1. ゆめマガディレクトリ全体構造

**最上位ディレクトリ構成**:
```
/mnt/c/ゆめマガ/
├── 00_テンプレート/          - 制作テンプレート
├── 01_企画管理/              - 企画関連文書
├── 02_素材ライブラリ/        - ブランド素材（ロゴ・フォント・カラー等）
├── 03_制作ガイドライン/      - 制作ルール・品質基準
├── 04_進行管理/              - スケジュール管理
├── 202506/                   - 6月号完成PDF
├── 202508/                   - 8月号完成PDF
├── 202510/                   - 10月号完成PNG（32ページ分）
├── 202511_サンプル/          - サンプル月号（制作フロー標準化）
├── Phase1_成果物/            - Phase1関連データ
├── Phase2_完成版_2025年10月号/ - Phase2完成版
├── 動的月号対応/              - Phase4 GASコード
├── 各種ドキュメント（Markdown）
```

#### 2. 素材ライブラリ（02_素材ライブラリ/）

**構成**:
- `カラーパレット/` - ブランドカラー定義
- `フォント/` - 使用フォント
- `ロゴ/` - ゆめマガ・ゆめスタロゴ
- `共通画像/` - 共通素材

**用途**: デザイン統一・ブランドアイデンティティ維持

#### 3. テンプレート（00_テンプレート/）

**デザインテンプレート**:
- 空（今後追加予定）

**文書テンプレート**:
- `インタビュー質問票.txt` - 標準質問フォーマット
- `企業情報記入シート.txt` - 企業情報収集フォーマット
- `校正チェックリスト.txt` - 品質チェック項目

**素材テンプレート**:
- （未確認）

**用途**: 作業標準化・品質均一化

#### 4. 制作ガイドライン（03_制作ガイドライン/）

**構成**:
- `01_撮影ガイド/` - 撮影ルール
- `02_文字数ガイド/` - ページ別文字数規定
- `03_デザインガイド/` - デザインルール
- `04_編集ガイド/` - 編集・校正ルール
- `製作ガイドライン集.md` - 統合ガイドライン
- `月刊誌製作体系化_分析レポート.md` - 体系化分析

**主要内容**:
- 撮影ガイドライン（人物・職場・製品撮影）
- 文字数規定（見出し・本文・キャプション）
- デザインルール（カラーパレット・フォント・レイアウト）
- 編集ガイドライン（校正記号・ワークフロー）
- 品質チェックリスト
- 著作権・肖像権管理
- データ管理・バージョン管理

**用途**: 制作品質の標準化・新メンバー教育

#### 5. 進行管理（04_進行管理/）

**構成**:
- `マスタースケジュール/` - 全体スケジュール
- `月別スケジュール/` - 月号別スケジュール
- `進捗管理/` - 進捗トラッキング

**用途**: スケジュール管理・進捗可視化

#### 6. 月号別ディレクトリ（202506, 202508, 202510）

**202506（6月号）**:
- `マガ 6月号.pdf` (143MB)
- `マガ+6月号-圧縮.pdf` (8.2MB)

**202508（8月号）**:
- `ゆめマガ　8月号 (3).pdf` (132MB)
- `ゆめマガ　8月号 (3)-compressed.pdf` (3.9MB)

**202510（10月号）**:
- PNG画像ファイル（1.png〜32.png、計32ページ分、計54MB）

**特徴**:
- 完成版PDFまたはPNG
- 圧縮版を併用
- 月号ごとに命名規則が異なる（標準化が必要）

#### 7. 202511_サンプル（サンプル月号）

**構成**:
```
202511_サンプル/
├── 01_企画/         - 企画書・企画関連文書
├── 02_取材/         - 取材素材・録音データ・写真
├── 03_原稿/         - 原稿・文字起こし
├── 04_デザイン/     - レイアウトデータ・画像編集
├── 05_校正/         - 校正データ・確認依頼
├── 06_最終データ/   - 完成PDF・印刷データ
└── 99_管理/         - 進捗管理・連絡履歴
```

**用途**: 新しい月号制作時の標準フォルダ構造（コピーして使用）

#### 8. 運用マニュアル（00_運用マニュアル.md）

**主要内容**:
- システム概要
- ディレクトリ構造説明
- 使用開始手順（新月号準備・ガントチャート利用）
- 取材・制作フローの詳細
- 定期作業（毎日・毎週・毎月）
- ファイル命名規則・バージョン管理
- チーム役割分担（編集長・営業・取材・ライター・デザイナー・校正）
- 品質管理ポイント
- トラブル対応
- 継続的改善・振り返り

**用途**: チーム全員の作業標準化・新メンバー教育

#### 9. 制作体系化の特徴

**完全体系化された制作プロセス**:
- 企画 → 取材 → 原稿 → デザイン → 校正 → 最終データ
- 各フェーズの標準フォルダ（202511_サンプル）
- 各フェーズのガイドライン（03_制作ガイドライン）
- 各フェーズのテンプレート（00_テンプレート）
- 進捗管理ツール（Phase4逆算スケジューラー）

**品質管理の徹底**:
- 撮影品質（解像度・構図・照明ルール）
- 文章品質（文字数・文体・校正）
- デザイン品質（カラー・フォント・レイアウト）
- 印刷品質（CMYK変換・塗り足し・フォント埋め込み）

**チーム協業の最適化**:
- 役割分担（6つの役割）
- ワークフロー明確化
- コミュニケーションルール
- 進捗共有の仕組み

#### 10. 統合ダッシュボードとの関連性

**統合ダッシュボードで管理すべき要素**:
1. **Phase4逆算スケジューラー**: 工程管理・ガントチャート
2. **素材管理**: 素材ライブラリ・月号別素材の一元管理
3. **品質チェック**: ガイドライン遵守確認・チェックリスト管理
4. **テンプレート管理**: 標準フォーマットの配布・バージョン管理
5. **完成PDF管理**: 月号別PDF・圧縮版の一元管理
6. **パートナー・スターデータ**: スプレッドシート連携

**MVP範囲外（Phase 2以降）**:
- 素材ライブラリの統合
- ガイドライン管理機能
- テンプレート配布機能
- PDF管理機能

**MVP範囲内**:
- Phase4逆算スケジューラー連携（工程管理）
- パートナー・スターデータ連携

### Step 4: 統合ダッシュボード連携仕様検討 ✅ 完了
**調査内容**:
- [x] コンテンツ連動の自動化レベル検討
- [x] HP連携の仕様検討
- [x] データ同期の方法検討

**調査結果**:

#### 1. コンテンツ連動の自動化レベル検討

**連動対象の整理**:

**ゆめマガ ⇔ yumesutaHP の連動関係**:
- **パートナー企業データ**: 同じスプレッドシート（ID: `12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc`）を共有
- **スター紹介データ**: 同じスプレッドシート（ID: `12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc`）を共有
- **企業ページ**: 同じデータソースを参照

**データの流れ（現状）**:
```
スプレッドシート（インタビュー回答収集）
  ↓ 手動
CANVA（ゆめマガPDF作成）
  ↓ 手動
yumesutaHP（STAR紹介・パートナー一覧・企業ページ）
```

**自動化レベルの提案**:

**レベル1（MVP - 最小限）**:
- ✅ スプレッドシートをGoogle Sheets API経由で読み取り専用連携
- ✅ ダッシュボードで一覧表示のみ
- ✅ 更新は各システムで手動実施

**レベル2（Phase 2）**:
- スプレッドシート更新を検知してHPに自動反映
- 新規パートナー追加時に自動でページ生成
- 新規スター追加時に自動でページ生成

**レベル3（Phase 3以降）**:
- CANVA連携（可能であれば）
- PDF自動生成・配置
- 完全自動化

**✅ MVP推奨**: レベル1（読み取り専用・表示のみ）

---

#### 2. HP連携の仕様検討

**連携データの詳細**:

**連携対象スプレッドシート**（ID: `12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc`）:

**想定シート構成**（※要確認）:
- パートナー企業一覧シート
- スター紹介一覧シート
- インタビュー回答収集シート

**HP側の連携ページ**（yumesutaHP）:
- `/src/app/partners/` - パートナー企業一覧（予定）
- `/src/app/stars/` - スター紹介（予定）
- `/src/app/yumemaga/page.tsx` - ゆめマガ一覧

**連携仕様（MVP）**:

1. **読み取り方式**: Google Sheets API（サービスアカウント認証）
2. **更新頻度**:
   - リアルタイム不要（日次バッチ更新でも可）
   - または手動更新トリガー
3. **表示形式**:
   - ダッシュボード: テーブル表示
   - HP: カード形式・一覧形式
4. **データキャッシュ**:
   - ダッシュボード側でキャッシュ保持
   - 定期同期（1日1回程度）

---

#### 3. データ同期の方法検討

**同期対象の整理**:

**同期対象1: Phase4逆算スケジューラー**
- スプレッドシートID: `1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw`
- 同期方向: スプレッドシート → ダッシュボード（読み取り専用）
- 更新頻度: リアルタイム or 5分ごと（工程管理のため頻度高め推奨）

**同期対象2: パートナー・スターデータ**
- スプレッドシートID: `12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc`
- 同期方向: スプレッドシート → ダッシュボード・HP（読み取り専用）
- 更新頻度: 日次バッチ or 手動トリガー

**同期方法の選択肢**:

**方法A: ポーリング方式**
- ダッシュボードから定期的にGoogle Sheets APIを呼び出し
- メリット: 実装がシンプル
- デメリット: API quota消費、リアルタイム性が低い

**方法B: Webhook方式**
- Google Apps Scriptでスプレッドシート更新時にダッシュボードへ通知
- メリット: リアルタイム、API quota節約
- デメリット: 実装が複雑

**方法C: ハイブリッド方式**
- Phase4スケジューラー: 方法A（5分ごとポーリング）
- パートナー・スターデータ: 方法B（Webhook）または手動トリガー

**✅ MVP推奨**: 方法A（ポーリング方式）- 実装シンプル・確実

**技術実装案**:
```
技術スタック:
- Google Sheets API v4
- 認証: サービスアカウント（JSON key）
- 実装言語: Node.js / TypeScript
- フレームワーク: Next.js（yumesutaHPと統合）

ポーリング間隔:
- Phase4スケジューラー: 5分
- パートナー・スターデータ: 1時間 or 日次
```

---

#### 4. 月号ごとのスプレッドシート変更問題への対応

**課題**: Phase4逆算スケジューラーは月号ごとにスプレッドシートが変わる

**解決案**:

**案A: 月号マスター管理**
- 月号とスプレッドシートIDの対応表を管理
- ダッシュボードで月号を選択 → 対応するスプレッドシートを表示

**案B: 専用ダッシュボードシート作成**
- ガントチャート用シートとは別に、ダッシュボード連携専用シートを作成
- 月号が変わってもこのシート1つを更新すれば全月号を管理

**案C: 統合スプレッドシート作成**
- 全月号のデータを1つのスプレッドシートに集約
- 月号別にシートを分ける

**✅ MVP推奨**: 案A（月号マスター管理）- 最小変更・既存運用を維持

---

#### 5. MVP範囲の最終確認

**統合ダッシュボードMVP機能**:

1. **ゆめマガ制作進捗管理（Phase4逆算スケジューラー）**
   - Google Sheets API連携（読み取り専用）
   - スケジュールシート表示
   - ガントチャート表示（60日間・担当区分別色分け）
   - 外部依存工程のハイライト表示
   - 遅延アラート表示

2. **営業進捗管理**
   - Google Sheets API連携（読み取り専用）
   - KPI表示

3. **パートナー・スターデータ管理**
   - Google Sheets API連携（読み取り専用）
   - 一覧表示
   - 詳細表示

**MVP範囲外（Phase 2以降）**:
- HP自動更新機能
- CANVA連携
- PDF自動生成・配置
- 双方向同期（スプレッドシートへの書き込み）
- 素材ライブラリの統合
- ガイドライン管理機能
- テンプレート配布機能
- PDF管理機能

### Step 5: 最終調査結果まとめ ✅ 完了
**調査内容**:
- [x] 全調査結果の統合
- [x] 統合ダッシュボードへの統合方針確定
- [x] 要件定義書への反映

---

## 📊 最終調査結果まとめ（Step 1-4統合）

### 1. ゆめマガディレクトリ全体像

**ディレクトリサイズ**: 1.17 GB
**パス**: `/mnt/c/ゆめマガ`

**構成要素**:
1. **完成PDFファイル**: 月号別（202506, 202508, 202510）
2. **Phase4逆算スケジューラー**: 工程管理GAS（97工程・60日サイクル）
3. **パートナー・スターデータ**: スプレッドシート連携（yumesutaHPと共有）
4. **制作体系**: テンプレート・ガイドライン・素材ライブラリ

---

### 2. 統合ダッシュボード連携対象の整理

#### 連携対象1: Phase4逆算スケジューラー（最重要）

**スプレッドシートID**: `1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw`

**特徴**:
- 97工程（従来72工程から拡張）
- 60日間制作サイクル（従来30日から拡張）
- 校了日（Z-3: 28日目）からの逆算配置
- 7種類のマスターデータ（逆算依存関係、負荷制約、期間制約等）
- 外部依存期間（7日間）の自動考慮

**連携方式（MVP）**:
- Google Sheets API（読み取り専用）
- ポーリング方式（5分間隔）
- サービスアカウント認証

**表示機能（MVP）**:
- スケジュールシート表示（工程No・工程名・開始予定日・完了予定日・実際開始日・実際完了日・ステータス・遅延日数・担当区分）
- ガントチャート表示（60日間・担当区分別色分け）
- 外部依存工程のハイライト表示
- 遅延アラート表示

**課題と対策**:
- **課題**: 月号ごとにスプレッドシートが変わる
- **対策**: 月号マスター管理方式（月号とスプレッドシートIDの対応表を管理）

---

#### 連携対象2: パートナー・スターデータ

**スプレッドシートID**: `12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc`

**特徴**:
- インタビュー回答収集・管理
- yumesutaHP（STAR紹介・パートナー一覧・企業ページ）と同じデータソース共有
- CANVAでゆめマガPDF作成時に使用

**データの流れ**:
```
スプレッドシート（インタビュー回答収集）
  ↓ 手動
CANVA（ゆめマガPDF作成）
  ↓ 手動
yumesutaHP（STAR紹介・パートナー一覧・企業ページ）
```

**連携方式（MVP）**:
- Google Sheets API（読み取り専用）
- ポーリング方式（1時間 or 日次）
- サービスアカウント認証

**表示機能（MVP）**:
- パートナー企業一覧表示
- スター紹介一覧表示
- 詳細表示

**自動化レベル（MVP）**:
- レベル1: スプレッドシート読み取り専用・表示のみ
- 更新は各システムで手動実施

---

#### 連携対象3: 完成PDFファイル（MVP範囲外）

**現状**:
- 月号別ディレクトリ（202506, 202508, 202510）
- PDF形式 または PNG画像形式
- 圧縮版を併用

**Phase 2以降の検討事項**:
- PDF管理機能
- サムネイル生成
- 自動配置

---

#### 連携対象4: 制作体系（MVP範囲外）

**現状**:
- 素材ライブラリ（256 MB）
- テンプレート（インタビュー質問票・企業情報記入シート・校正チェックリスト）
- 制作ガイドライン（撮影・文字数・デザイン・編集）
- 進行管理（マスタースケジュール・月別スケジュール）

**Phase 2以降の検討事項**:
- 素材ライブラリの統合
- ガイドライン管理機能
- テンプレート配布機能

---

### 3. 統合ダッシュボードMVP機能要件（確定版）

#### 機能1: ゆめマガ制作進捗管理

**データソース**: Phase4逆算スケジューラー（スプレッドシートID: `1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw`）

**機能詳細**:
1. **スケジュール表示**
   - 工程No・工程名
   - 開始予定日・完了予定日（逆算で自動計算）
   - 実際開始日・実際完了日
   - ステータス（未開始/進行中/完了）
   - 遅延日数（自動計算）
   - 担当区分（インタビュワー・撮影陣 / 制作陣 / 外部依頼）

2. **ガントチャート表示**
   - 60日間の工程を可視化
   - 担当区分別色分け
     - インタビュワー・撮影陣: 緑系
     - 制作陣: 青系
     - 外部依頼: 橙系

3. **外部依存工程のハイライト**
   - 確認送付工程（A-14, A-15, K-7, L-10, M-10, H-9, I-9, C-8, E-4, P-4）を強調表示
   - 7日間の回答待ち期間を可視化

4. **遅延アラート**
   - 予定完了日を過ぎた工程を自動検出
   - 遅延日数を表示
   - アラート通知（オプション）

5. **月号選択機能**
   - 月号マスター管理（月号とスプレッドシートIDの対応表）
   - 月号をドロップダウンで選択
   - 対応するスプレッドシートのデータを表示

**技術仕様**:
- API: Google Sheets API v4
- 認証: サービスアカウント（JSON key）
- 同期方式: ポーリング（5分間隔）
- 実装言語: Node.js / TypeScript
- フレームワーク: Next.js（yumesutaHPと統合）

---

#### 機能2: パートナー・スターデータ管理

**データソース**: パートナー・スターデータスプレッドシート（スプレッドシートID: `12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc`）

**機能詳細**:
1. **パートナー企業一覧**
   - 企業名・業種・所在地・掲載月号
   - カード形式表示
   - 検索・フィルタリング機能

2. **スター紹介一覧**
   - 氏名・職種・企業名・掲載月号
   - カード形式表示
   - 検索・フィルタリング機能

3. **詳細表示**
   - インタビュー回答内容
   - 写真・素材データ
   - 掲載状況（ゆめマガ・HP）

**技術仕様**:
- API: Google Sheets API v4
- 認証: サービスアカウント（JSON key）
- 同期方式: ポーリング（1時間 or 日次）
- データキャッシュ: ダッシュボード側で保持
- 実装言語: Node.js / TypeScript
- フレームワーク: Next.js（yumesutaHPと統合）

---

#### 機能3: HP連携（参照表示のみ）

**連携ページ**（yumesutaHP）:
- `/src/app/partners/` - パートナー企業一覧（予定）
- `/src/app/stars/` - スター紹介（予定）
- `/src/app/yumemaga/page.tsx` - ゆめマガ一覧

**連携仕様**:
- ダッシュボードとHPは同じスプレッドシートを参照
- HPは独立して動作（ダッシュボード経由ではない）
- ダッシュボード上でHP連携状況を確認可能（参照表示のみ）

---

### 4. MVP範囲外（Phase 2以降）

**自動化機能**:
- HP自動更新機能（スプレッドシート更新時にHP自動反映）
- 新規パートナー追加時の自動ページ生成
- 新規スター追加時の自動ページ生成
- CANVA連携（可能であれば）
- PDF自動生成・配置

**管理機能**:
- 素材ライブラリの統合
- ガイドライン管理機能
- テンプレート配布機能
- PDF管理機能

**双方向同期**:
- ダッシュボードからスプレッドシートへの書き込み
- リアルタイム双方向同期

---

### 5. 技術アーキテクチャ（MVP）

**技術スタック**:
```
フロントエンド: Next.js (TypeScript)
バックエンド: Next.js API Routes
データ連携: Google Sheets API v4
認証: サービスアカウント（JSON key）
キャッシュ: Redis or In-Memory Cache
デプロイ: Vercel or AWS
```

**ポーリング間隔**:
- Phase4スケジューラー: 5分
- パートナー・スターデータ: 1時間 or 日次

**API Quota管理**:
- Google Sheets API: 500 requests per 100 seconds per project
- キャッシュ活用でAPI呼び出しを最小化

---

### 6. データフロー図

```
┌─────────────────────────────────────────────────────┐
│  Google Spreadsheets                                │
│                                                     │
│  1. Phase4逆算スケジューラー                          │
│     ID: 1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw │
│                                                     │
│  2. パートナー・スターデータ                          │
│     ID: 12A5mroEA5ipsIM88y4GOTmK61-V95bnAV5eTEhejvpc │
└─────────────────────────────────────────────────────┘
                        ↓
            Google Sheets API v4
         (サービスアカウント認証)
                        ↓
┌─────────────────────────────────────────────────────┐
│  統合ダッシュボード（Next.js）                        │
│                                                     │
│  ┌─────────────────────────────────────────┐       │
│  │ API Routes（ポーリング処理）              │       │
│  │  - Phase4スケジューラー: 5分間隔          │       │
│  │  - パートナー・スターデータ: 1時間 or 日次 │       │
│  └─────────────────────────────────────────┘       │
│                        ↓                            │
│  ┌─────────────────────────────────────────┐       │
│  │ キャッシュ層（Redis or In-Memory）        │       │
│  └─────────────────────────────────────────┘       │
│                        ↓                            │
│  ┌─────────────────────────────────────────┐       │
│  │ フロントエンド（React）                   │       │
│  │  - ゆめマガ制作進捗管理画面               │       │
│  │  - パートナー・スターデータ管理画面        │       │
│  │  - 営業進捗管理画面                      │       │
│  └─────────────────────────────────────────┘       │
└─────────────────────────────────────────────────────┘
                        ↓
┌─────────────────────────────────────────────────────┐
│  yumesutaHP（Next.js）                              │
│                                                     │
│  - /partners/ - パートナー企業一覧                    │
│  - /stars/ - スター紹介                              │
│  - /yumemaga/ - ゆめマガ一覧                         │
│                                                     │
│  ※ダッシュボードとは独立（同じスプレッドシートを参照） │
└─────────────────────────────────────────────────────┘
```

---

### 7. 実装優先順位（MVP開発順序）

**Phase 1-1: 基盤構築**
1. Google Sheets API連携実装
2. サービスアカウント認証設定
3. ポーリング機構実装
4. キャッシュ層実装

**Phase 1-2: Phase4スケジューラー連携**
1. スケジュールシート読み取り実装
2. データ整形・表示実装
3. ガントチャート表示実装
4. 外部依存工程ハイライト実装
5. 遅延アラート実装
6. 月号選択機能実装

**Phase 1-3: パートナー・スターデータ連携**
1. スプレッドシート読み取り実装
2. パートナー企業一覧表示
3. スター紹介一覧表示
4. 検索・フィルタリング機能
5. 詳細表示機能

**Phase 1-4: 統合・テスト**
1. 全機能の統合
2. エラーハンドリング
3. パフォーマンス最適化
4. ユーザーテスト・フィードバック

---

### 8. 要件定義書への反映事項

#### システム概要
- **目的**: ゆめマガ制作工程・パートナー企業・スター紹介の一元管理
- **範囲**: Phase4逆算スケジューラー・パートナー・スターデータの可視化（MVP）

#### 機能要件
1. ゆめマガ制作進捗管理（Phase4逆算スケジューラー連携）
2. パートナー・スターデータ管理
3. 営業進捗管理（既存: sales-management-system連携）

#### データ要件
- Google Sheets API経由でスプレッドシートデータを取得
- 読み取り専用（MVP）
- ポーリング方式（5分〜日次）

#### 非機能要件
- レスポンスタイム: 2秒以内
- 可用性: 99.9%
- API Quota管理: キャッシュ活用
- セキュリティ: サービスアカウント認証

#### 開発計画
- MVP開発期間: 4-6週間（Phase 1-1〜1-4）
- Phase 2以降: HP自動更新・双方向同期等

---

## ✅ ゆめマガ調査完了

**調査期間**: 2025-10-04
**調査ステップ**: Step 1〜5（全5ステップ完了）

**主要成果**:
1. Phase4逆算スケジューラーの詳細把握（97工程・60日サイクル・逆算配置）
2. パートナー・スターデータとyumesutaHPの連携関係の把握
3. 統合ダッシュボードMVP機能要件の確定
4. 技術アーキテクチャ・実装優先順位の策定

**次のフェーズ**: Phase 3 - yumesutaHP補足調査

---

## ✅ ユーザー確認事項

### Phase4調査結果の確認

1. **Phase4スプレッドシートの特定**
   - GASによって作成されたスプレッドシートはPhase4版（逆算スケジューラー）で正しいですか？
   - 従来Phase1版との違いを理解いただけましたか？

2. **Phase4の特徴理解**
   - 逆算スケジューラー（校了日から逆算配置）
   - 97工程（従来72工程から拡張）
   - 60日間制作サイクル（従来30日から拡張）
   - 7種類のマスターデータ（逆算依存関係、負荷制約、期間制約等）

   この理解は正しいですか？

3. **MVP範囲の確認**
   - ゆめマガ制作進捗管理機能（Phase4逆算スケジューラー）を統合ダッシュボードのMVP範囲に含めますか？
   - Google Sheets API連携（読み取り専用）で問題ありませんか？

4. **スプレッドシートの場所確認** ✅ 確認済み
   - **URL**: https://docs.google.com/spreadsheets/d/1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw/edit?gid=548026099#gid=548026099
   - **スプレッドシートID**: `1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw`
   - **注意**: 月号ごとにスプレッドシートが変わる
   - **ダッシュボード連携案**: ガントチャートとは別にダッシュボード用のシートを作成することを検討

5. **次回調査の優先順位確認** ✅ 確認済み
   - Step 2以降の調査を継続します

---

## 📌 重要な発見・修正

### Phase1からPhase4への重要な修正
高卒採用リサーチディレクトリの調査で、ユーザーから「GASによって作成された**スプレッドシート**が最もダッシュボードと関連性として重要」との指摘を受けました。

当初、Phase1の古いバージョン（72工程・30日間サイクル）を調査していましたが、実際には**Phase4の逆算スケジューラー**（97工程・60日間サイクル・逆算配置）が最新版であることが判明しました。

### Phase4の高度な機能
Phase4は単なる工程管理ではなく、**逆算スケジューリング**により校了日厳守を実現する高度なシステムです：
- 校了日（Z-3: 28日目）を起点とした逆算配置
- 外部依存期間（7日間）の自動考慮
- 制約管理（期間制約、負荷制約、カテゴリ同期）
- 内部チェック系工程の強制配置（B-1開始前完了必須）

**統合ダッシュボードへの統合は必須**と判断します。

---

## 🚨 Phase4の未解決課題（参考情報）

### 引き継ぎドキュメントに記載されていた課題
Phase4の引き継ぎドキュメント（`次世代Claude_完全引き継ぎドキュメント_逆算スケジューラー実装.md`）に、以下の未解決課題が記載されていました：

1. **内部チェック系工程の未配置問題**
   - A-13, K-6, L-9, M-9, H-8, I-8, C-7, E-3, P-3が配置されない
   - 校了日後配置問題の根本原因

2. **Layer3の設計破綻**
   - カテゴリ同期マスター由来の配置ロジックとハードコード個別配置の混在
   - ページ制作工程の配置ロジックが混乱

**注**: これらは技術的な実装課題であり、統合ダッシュボードの要件定義には直接影響しません。ユーザーがPhase4スプレッドシートを実際に使用している場合、これらの課題が解決済みか、回避策が取られている可能性があります。

---

**調査者**: Claude Code
**調査日**: 2025-10-04
**修正日**: 2025-10-04（Phase1 → Phase4に修正）
**ステータス**: ✅ Phase4調査完了 / Step 2以降は次回セッション
**次回調査**: PDF構造・パートナー企業データ確認
