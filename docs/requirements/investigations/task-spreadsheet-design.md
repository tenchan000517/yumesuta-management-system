# タスク管理スプレッドシート設計書

**作成日**: 2025-10-05
**バージョン**: 1.0
**ステータス**: 設計完了

---

## 📋 概要

個人タスク・プロジェクトタスクを一元管理し、進捗状況をガントチャート形式で可視化するためのGoogle Sheetsスプレッドシート設計書。

---

## 🎯 目的

- 日々のタスク管理の効率化
- プロジェクトの進捗可視化
- 遅延タスクの早期発見
- 優先度に基づいたタスク管理

---

## 📊 スプレッドシート構造

### シート1: タスク一覧

**シート名**: `タスク一覧`

**用途**: 個人タスク・プロジェクトタスクの詳細管理

**列構成**:

| 列 | 項目名 | データ型 | 説明 | 例 |
|----|--------|----------|------|-----|
| A | タスクID | 文字列 | 一意のタスクID | TASK-001 |
| B | タスク名 | 文字列 | タスクの名称 | Phase4スケジューラー実装 |
| C | プロジェクト名 | 文字列 | 所属プロジェクト（個人タスクは空欄） | 統合マネジメントシステム |
| D | 優先度 | 文字列 | 高 / 中 / 低 | 高 |
| E | ステータス | 文字列 | 未着手 / 進行中 / 完了 / 保留 | 進行中 |
| F | 開始予定日 | 日付 | タスク開始予定日 | 2025-10-05 |
| G | 終了予定日 | 日付 | タスク完了予定日 | 2025-10-12 |
| H | 実際の開始日 | 日付 | 実際の開始日（未開始の場合は空欄） | 2025-10-05 |
| I | 実際の完了日 | 日付 | 実際の完了日（未完了の場合は空欄） | - |
| J | 進捗率 | 数値 | 進捗率（%） | 60 |
| K | 担当者 | 文字列 | タスク担当者名 | 山田太郎 |
| L | 備考 | 文字列 | その他メモ | API実装完了、UI実装中 |

**サンプルデータ（7件）**:

```
タスクID    タスク名                          プロジェクト名                  優先度  ステータス  開始予定日   終了予定日   実際の開始日  実際の完了日  進捗率  担当者      備考
TASK-001   Phase4スケジューラー実装            統合マネジメントシステム          高      完了       2025-10-01  2025-10-05  2025-10-01   2025-10-05   100    山田太郎    完了
TASK-002   SNS投稿管理機能実装                統合マネジメントシステム          高      完了       2025-10-05  2025-10-05  2025-10-05   2025-10-05   100    山田太郎    完了
TASK-003   タスク管理機能実装                 統合マネジメントシステム          高      進行中     2025-10-05  2025-10-06  2025-10-05                70     山田太郎    スプレッドシート設計完了
TASK-004   統合テスト・バグ修正               統合マネジメントシステム          中      未着手     2025-10-07  2025-10-13                              0      山田太郎    Phase1-8対応
TASK-005   営業先リスト更新                   -                              中      進行中     2025-10-04  2025-10-06  2025-10-04                80     山田太郎    あと3社
TASK-006   ゆめマガ11月号コンテンツ確認        -                              高      未着手     2025-10-06  2025-10-08                              0      山田太郎    校正待ち
TASK-007   次回営業会議資料作成               -                              低      保留       2025-10-10  2025-10-12                              0      山田太郎    日程調整中
```

---

### シート2: プロジェクト一覧

**シート名**: `プロジェクト一覧`

**用途**: プロジェクトの基本情報・進捗サマリー管理

**列構成**:

| 列 | 項目名 | データ型 | 説明 | 例 |
|----|--------|----------|------|-----|
| A | プロジェクトID | 文字列 | 一意のプロジェクトID | PROJ-001 |
| B | プロジェクト名 | 文字列 | プロジェクトの名称 | 統合マネジメントシステム |
| C | 説明 | 文字列 | プロジェクトの概要 | 業務統合管理システムMVP開発 |
| D | ステータス | 文字列 | 計画中 / 進行中 / 完了 / 中止 | 進行中 |
| E | 開始日 | 日付 | プロジェクト開始日 | 2025-10-04 |
| F | 終了予定日 | 日付 | プロジェクト完了予定日 | 2025-12-13 |
| G | 進捗率 | 数値 | プロジェクト全体の進捗率（%） | 70 |
| H | 備考 | 文字列 | その他メモ | Phase1-7実装中 |

**サンプルデータ（2件）**:

```
プロジェクトID  プロジェクト名                説明                                  ステータス  開始日      終了予定日   進捗率  備考
PROJ-001       統合マネジメントシステム        業務統合管理システムMVP開発              進行中     2025-10-04  2025-12-13  70     Phase1-7実装中
PROJ-002       ゆめマガリニューアル           ゆめマガのデザイン・コンテンツ刷新         計画中     2025-11-01  2025-12-31  0      企画検討中
```

---

## 🔧 作成手順

### 1. Google Sheetsで新規スプレッドシート作成

1. Google Sheetsにアクセス: https://sheets.google.com
2. 新規スプレッドシートを作成
3. スプレッドシート名を `タスク管理` に変更

### 2. シート1作成: タスク一覧

1. シート名を `タスク一覧` に変更
2. 1行目にヘッダーを入力:
   - A1: `タスクID`
   - B1: `タスク名`
   - C1: `プロジェクト名`
   - D1: `優先度`
   - E1: `ステータス`
   - F1: `開始予定日`
   - G1: `終了予定日`
   - H1: `実際の開始日`
   - I1: `実際の完了日`
   - J1: `進捗率`
   - K1: `担当者`
   - L1: `備考`
3. 2行目以降にサンプルデータを入力（上記サンプルデータ参照）

### 3. シート2作成: プロジェクト一覧

1. 新しいシートを追加
2. シート名を `プロジェクト一覧` に変更
3. 1行目にヘッダーを入力:
   - A1: `プロジェクトID`
   - B1: `プロジェクト名`
   - C1: `説明`
   - D1: `ステータス`
   - E1: `開始日`
   - F1: `終了予定日`
   - G1: `進捗率`
   - H1: `備考`
4. 2行目以降にサンプルデータを入力（上記サンプルデータ参照）

### 4. サービスアカウントに共有権限を付与

1. スプレッドシートの「共有」ボタンをクリック
2. サービスアカウントのメールアドレスを追加:
   - `yumesuta-management-sys@fair-yew-446514-q5.iam.gserviceaccount.com`
3. 権限を「閲覧者」に設定
4. 「送信」をクリック

### 5. スプレッドシートIDを控える

スプレッドシートのURLから、スプレッドシートIDを控える:
- URL例: `https://docs.google.com/spreadsheets/d/【スプレッドシートID】/edit`
- スプレッドシートID: `1234567890abcdefghijklmnopqrstuvwxyz`（この部分をコピー）

---

## 🎯 データ入力ルール

### 優先度

- `高`: 緊急かつ重要なタスク
- `中`: 通常のタスク
- `低`: 優先度の低いタスク

### ステータス

- `未着手`: タスク未開始
- `進行中`: タスク進行中
- `完了`: タスク完了
- `保留`: タスク一時停止

### プロジェクト名

- プロジェクトに紐づくタスクの場合: プロジェクト一覧シートの「プロジェクト名」と一致させる
- 個人タスクの場合: 空欄 または `-`

### 日付形式

- `YYYY-MM-DD` 形式（例: `2025-10-05`）
- Google Sheetsの日付セル形式を使用

### 進捗率

- 0〜100の整数（%）
- 未着手: 0%
- 完了: 100%

---

## 📊 データ管理フロー

### タスク進行フロー

1. **タスク作成**: タスク一覧シートに新しいタスクを追加
2. **タスク開始**: ステータスを「進行中」に変更、実際の開始日を入力
3. **進捗更新**: 進捗率を随時更新、備考に進捗メモを追加
4. **タスク完了**: ステータスを「完了」に変更、実際の完了日を入力、進捗率を100%に更新

### プロジェクト管理フロー

1. **プロジェクト作成**: プロジェクト一覧シートに新しいプロジェクトを追加
2. **タスク紐付け**: タスク一覧シートでプロジェクト名を入力
3. **進捗計算**: プロジェクトに紐づくタスクの進捗率を元に、プロジェクト全体の進捗率を手動で更新

---

## 🔍 システム連携仕様

### API連携方式

- **API**: Google Sheets API v4
- **認証**: サービスアカウント（JSON key）
- **同期方式**: 手動更新（ボタンクリック時にAPI呼び出し）
- **読み取り範囲**:
  - タスク一覧: `タスク一覧!A1:L1000`
  - プロジェクト一覧: `プロジェクト一覧!A1:H100`

### 遅延タスク判定ロジック

タスク一覧シートで以下を判定:

- **遅延タスク**: 終了予定日 < 現在日 かつ ステータス != "完了"
- **遅延アラート**: 遅延タスクの件数を表示

### ガントチャート表示ロジック

- タスク一覧シートから「開始予定日」「終了予定日」「ステータス」「進捗率」を取得
- ダッシュボード上でガントチャート形式で可視化
- 色分け:
  - 未着手: グレー
  - 進行中: ブルー
  - 完了: グリーン
  - 保留: イエロー
  - 遅延: レッド

---

## 📝 注意事項

### MVP範囲

- ❌ タスク・プロジェクトの作成・編集はダッシュボードから不可（スプレッドシートで手動入力）
- ❌ 自動進捗率計算は範囲外（手動更新）
- ✅ スプレッドシートでの手動データ入力・管理
- ✅ ダッシュボードでの読み取り専用表示
- ✅ ガントチャート表示

### Phase 2以降の拡張

- ダッシュボードからのタスク・プロジェクト作成・編集機能
- プロジェクトに紐づくタスクの進捗率自動計算
- タスク通知機能（期限1日前アラート等）
- カンバンボード表示

---

## ✅ 作成完了チェックリスト

- [ ] Google Sheetsで新規スプレッドシート作成
- [ ] スプレッドシート名を「タスク管理」に変更
- [ ] シート1「タスク一覧」作成・ヘッダー入力
- [ ] シート1にサンプルデータ7件入力
- [ ] シート2「プロジェクト一覧」作成・ヘッダー入力
- [ ] シート2にサンプルデータ2件入力
- [ ] サービスアカウントに閲覧権限を付与
- [ ] スプレッドシートIDを控える
- [ ] `.env.local` に `TASKS_SPREADSHEET_ID` を追加

---

**作成者**: Claude Code (2025-10-05)
**次のステップ**: GASスクリプトでスプレッドシートを自動生成
