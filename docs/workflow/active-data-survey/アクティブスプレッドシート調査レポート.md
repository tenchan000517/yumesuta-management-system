# アクティブスプレッドシート調査レポート

**作成日**: 2025年10月11日
**作成者**: Claude Code
**目的**: 契約業務フロー統合に関連する、稼働中のGoogle Spreadsheetsの構造を事実ベースで把握する

---

## 📋 調査対象スプレッドシート

### 1. 営業予実管理スプレッドシート

**スプレッドシートID**: `13PzSnGekGxDWX7B1_TwczNibR6j_JxDb3UuquPX1GyQ`
**タイトル**: 株式会社ゆめスタ 営業予実管理
**URL**: https://docs.google.com/spreadsheets/d/13PzSnGekGxDWX7B1_TwczNibR6j_JxDb3UuquPX1GyQ/

**環境変数**: `SALES_SPREADSHEET_ID`

---

## 🗂️ 全シート一覧

営業予実管理スプレッドシートには**9つのシート**が含まれています:

| No | シート名 | シートID | 行数 | 列数 | 用途 |
|----|---------|---------|------|------|------|
| 1 | 日報 | 24061188 | 1000 | 26 | 営業活動の日報記録 |
| 2 | 顧客マスタ | 1991613278 | 1000 | 27 | 顧客情報の管理 |
| 3 | KPIダッシュボード | 470612535 | 1000 | 26 | 営業KPI・行動量の可視化 |
| 4 | 月次予実管理 | 783449100 | 1000 | 28 | 月別の予算・実績管理 |
| 5 | 契約・入金管理 | 791125447 | 1000 | 27 | 契約書類・入金状況の管理 |
| 6 | サービス・料金設定マスタ | 1316191566 | 1001 | 26 | サービス料金の設定 |
| 7 | 獲得率設定マスタ | 1587528975 | 1001 | 26 | 転換率の設定 |
| 8 | 入金サイト設定マスタ | 902436765 | 1000 | 26 | 入金サイクルの設定 |
| 9 | 月別配布管理 | 921375804 | 1000 | 23 | ゆめマガ配布実績の管理 |

---

## 📊 契約業務フロー関連シートの詳細調査

### シート5: 契約・入金管理

**シートID**: 791125447
**用途**: 契約業務フローの13ステップに対応するデータ管理

#### ヘッダー構造（全16項目）

| 列 | 項目名 | データ型 | 説明 | 契約フロー対応ステップ |
|----|--------|---------|------|----------------------|
| A | ID | 数値 | 契約ID | - |
| B | 企業名 | 文字列 | 契約企業名 | ステップ① 情報収集 |
| C | 契約サービス | 文字列 | サービス名（例: ゆめマガ） | ステップ① 情報収集 |
| D | 契約日 | 日付 | 契約成立日 | ステップ⑦ 契約完了確認 |
| E | 契約金額 | 金額 | 契約金額（税込） | ステップ① 情報収集 |
| F | 入金方法 | 文字列 | 一括 / 分割 | ステップ① 情報収集 |
| G | 契約書送付 | 日付 | 基本契約書送付日 | ステップ③ 基本契約書の押印・送信 |
| H | 契約書回収 | 日付 | 基本契約書回収日 | ステップ⑦ 契約完了確認 |
| I | 申込書送付 | 日付 | 申込書送付日 | ステップ⑤ 申込書の押印・送信 |
| J | 申込書回収 | 日付 | 申込書回収日 | ステップ⑦ 契約完了確認 |
| K | 入金予定日 | 日付 | 入金予定日 | ステップ⑧ 請求書作成・送付 |
| L | 入金実績日 | 日付 | 実際の入金日 | ステップ⑨ 入金確認 |
| M | 入金ステータス | 文字列 | 未入金 / 入金済 | ステップ⑨ 入金確認 |
| N | 遅延日数 | 数値 | 入金遅延日数 | - |
| O | 掲載開始号 | 文字列 | 掲載開始号（例: 2025年12月号） | ステップ⑬ 掲載 |
| P | 備考 | 文字列 | 備考欄 | - |

#### サンプルデータ（2行目）

```
ID: 1
企業名: 信藤建設
契約サービス: ゆめマガ
契約日: 2025/10/09
契約金額: ¥744,000
入金方法: 一括
契約書送付: （空欄）
契約書回収: （空欄）
申込書送付: （空欄）
申込書回収: （空欄）
入金予定日: 2025/11/30
入金実績日: （空欄）
入金ステータス: 未入金
遅延日数: （空欄）
掲載開始号: 2025年12月号
備考: （空欄）
```

#### システムとの連動方法

**取得対象**: 契約業務フローダッシュボードで一覧表示
**操作対象**: 各ステップ完了時に対応する列（契約書送付、申込書送付等）に日付を記録

---

### シート2: 顧客マスタ

**シートID**: 1991613278
**用途**: 顧客情報の管理（営業進捗・契約前段階）

#### 特徴

- 行数: 1000行
- 列数: 27列
- 固定行: 1行（ヘッダー）
- 固定列: 2列（ID、企業名）

#### システムとの連動方法

**取得対象**: 営業KPI APIで使用（商談予定、ステータス統計）
**操作対象**: 現時点では操作対象外（表示のみ）

**使用箇所**: `/api/sales-kpi` (app/api/sales-kpi/route.ts:32)

---

### シート3: KPIダッシュボード

**シートID**: 470612535
**用途**: 営業KPIと行動量の可視化

#### 特徴

- 行数: 1000行
- 列数: 26列

#### システムとの連動方法

**取得対象**: 営業KPI APIで使用（行動量、転換率）
**操作対象**: 現時点では操作対象外（表示のみ）

**使用箇所**: `/api/sales-kpi` (app/api/sales-kpi/route.ts:29)

---

### シート4: 月次予実管理

**シートID**: 783449100
**用途**: 月別の予算・実績管理

#### 特徴

- 行数: 1000行
- 列数: 28列

#### システムとの連動方法

**取得対象**: 営業KPI APIで使用（月次契約実績、売上実績、入金実績）
**操作対象**: 現時点では操作対象外（表示のみ）

**使用箇所**: `/api/sales-kpi` (app/api/sales-kpi/route.ts:30)

---

## 🔍 契約業務フローとの関連性

### 契約業務フロー13ステップとスプレッドシートの対応

| ステップ | タイトル | 主要関連シート | 記録項目 |
|---------|---------|--------------|---------|
| ① | 情報収集 | 顧客マスタ | 企業名、契約内容、金額 |
| ② | 基本契約書作成 | - | （Google Docs原本から作成） |
| ③ | 基本契約書の押印・送信 | 契約・入金管理 | 契約書送付（G列） |
| ④ | 申込書作成 | - | （Google Docs原本から作成） |
| ⑤ | 申込書の押印・送信 | 契約・入金管理 | 申込書送付（I列） |
| ⑥ | 重要事項説明（任意） | - | - |
| ⑦ | 契約完了確認 | 契約・入金管理 | 契約日（D列）、契約書回収（H列）、申込書回収（J列） |
| ⑧ | 請求書作成・送付 | 契約・入金管理 | 入金予定日（K列） |
| ⑨ | 入金確認 | 契約・入金管理 | 入金実績日（L列）、入金ステータス（M列） |
| ⑩ | 入金管理シート更新 | 月次予実管理 | 入金実績額 |
| ⑪ | 入金確認連絡・原稿依頼 | - | - |
| ⑫ | 制作・校正 | - | （ゆめマガ制作進捗ダッシュボード） |
| ⑬ | 掲載 | 契約・入金管理 | 掲載開始号（O列） |

### システム連動の設計方針

1. **読み取り（取得対象）**
   - 契約業務フローダッシュボードで「契約・入金管理」シートのデータを一覧表示
   - 各契約の進捗状況を可視化

2. **書き込み（操作対象）**
   - Phase 1（MVP）: LocalStorageのみ使用、Google Sheetsへの書き込みなし
   - Phase 2以降: 各ステップ完了時に対応する列に日付を自動記録

---

## 📝 調査結果まとめ

### ✅ 全シートを把握

営業予実管理スプレッドシートの全9シートの構造を把握しました。

### ✅ 全情報と項目を把握

特に契約業務フローに関連する「契約・入金管理」シートの全16項目を詳細に調査し、契約フローの13ステップとの対応関係を明確にしました。

### 📌 重要発見事項

1. **契約・入金管理シート**は契約業務フローの進捗管理に最適な構造を持っています
2. 既存のシート構造を活用することで、新規シート作成が不要です
3. 13ステップのうち、**7ステップ（③⑤⑦⑧⑨⑩⑬）**が直接スプレッドシートと連動します

### 🎯 次のフェーズへの示唆

- 契約業務フローダッシュボードは「契約・入金管理」シートをベースに設計可能
- 各ステップの進捗状況を視覚的に表示するUIが必要
- 日付フィールドへの記録機能（Phase 2）の実装時は、Google Sheets API の `updateSheetCell` メソッドを使用

---

**調査完了日**: 2025年10月11日
**調査者**: Claude Code
**次の作業**: Google Drive構造調査
