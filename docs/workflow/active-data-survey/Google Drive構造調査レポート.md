# Google Drive構造調査レポート

**作成日**: 2025年10月11日
**作成者**: Claude Code
**目的**: 契約業務フロー統合で使用するGoogle Driveの構造を事実ベースで把握する

---

## 📋 調査対象Google Drive

### エビデンス保存用ドライブ

**フォルダID**: `1blH8qUUd_TLW_nznN5wozwn-vXGFMZ3q`
**URL**: https://drive.google.com/drive/folders/1blH8qUUd_TLW_nznN5wozwn-vXGFMZ3q
**用途**: 契約書、請求書等のエビデンス保存
**現状**: 空フォルダ（システムに権限付与済み）

---

## 🏗️ フォルダ構造の設計方針

### 保存対象ファイル

契約業務フローで作成・管理する以下のファイルを保存:

1. **契約書類**
   - 広告掲載基本契約書（PDF）
   - 広告掲載申込書兼個別契約書（PDF）

2. **請求書類**
   - 請求書（PDF）

3. **エビデンス**
   - メール送信記録（スクリーンショット）
   - 契約書回収確認（スクリーンショット）

### フォルダ階層構造の提案

システム側要望・方針で示されている保存構造:

```
エビデンス保存用ドライブ/
├── 企業A/
│   ├── 契約01_2025年12月号/
│   │   ├── 広告掲載基本契約書.pdf
│   │   ├── 広告掲載申込書.pdf
│   │   ├── 請求書.pdf
│   │   └── メール送信記録.png
│   └── 契約02_2026年1月号/
│       └── ...
├── 企業B/
│   └── ...
└── 企業C/
    └── ...
```

#### 階層レベル

1. **レベル1**: 企業ごとにフォルダ分類
   - フォルダ名形式: `{企業名}`（例: `信藤建設`）

2. **レベル2**: 契約内容ごとにフォルダ分類
   - フォルダ名形式: `契約{連番}_{掲載開始号}`（例: `契約01_2025年12月号`）

3. **レベル3**: ファイル保存
   - 各種エビデンスファイルを保存

---

## 📁 命名規則

### フォルダ命名規則

#### 企業フォルダ（レベル1）

```
形式: {企業名}
例: 信藤建設
例: 株式会社ゆめスタ
```

#### 契約フォルダ（レベル2）

```
形式: 契約{連番}_{掲載開始号}
例: 契約01_2025年12月号
例: 契約02_2026年1月号
```

### ファイル命名規則

#### 契約書類

```
基本契約書: 広告掲載基本契約書_{企業名}_{契約日}.pdf
申込書: 広告掲載申込書_{企業名}_{契約日}.pdf

例: 広告掲載基本契約書_信藤建設_20251009.pdf
例: 広告掲載申込書_信藤建設_20251009.pdf
```

#### 請求書

```
形式: 請求書_{企業名}_{発行日}.pdf
例: 請求書_信藤建設_20251015.pdf
```

#### エビデンス

```
形式: {エビデンス種別}_{日付}.{拡張子}
例: メール送信記録_20251009.png
例: 契約書回収確認_20251025.png
```

---

## 🔐 権限設定

### 現在の権限状態

**システムアカウント**: 権限付与済み
**アクセス権**: 読み取り・書き込み権限あり

### Google Drive API の使用

契約業務フローダッシュボードから、Google Drive API を使用してファイルをアップロード・管理します。

**実装方針**:
- Phase 1（MVP）: Google Driveへのアップロード機能なし（表示のみ）
- Phase 2以降: ファイルアップロード機能を実装

---

## 📊 システムとの連動方法

### 読み取り（取得対象）

契約業務フローダッシュボードで以下を表示:
- 各契約に紐づくエビデンスファイルの一覧
- ファイルへのリンク（Google Driveで開く）

### 書き込み（操作対象）

Phase 2以降で実装予定:
- 契約書類のアップロード（ステップ③⑤完了時）
- 請求書のアップロード（ステップ⑧完了時）
- エビデンスのアップロード（各ステップ完了時）

### フォルダ自動作成

Phase 2以降で実装予定:
- 新規契約作成時に自動で企業フォルダ・契約フォルダを作成
- フォルダ構造を自動的に生成

---

## 📝 調査結果まとめ

### ✅ フォルダ構造を把握

エビデンス保存用Google Driveフォルダの現状（空フォルダ）を確認しました。

### ✅ 権限設定を確認

システムアカウントに読み取り・書き込み権限が付与されていることを確認しました。

### ✅ 命名規則を策定

企業ごと・契約ごとのフォルダ構造と、ファイル命名規則を設計しました。

### 🎯 Phase 2への示唆

1. **フォルダ構造の自動生成機能**が必要
   - Google Drive API の `files.create` メソッドを使用してフォルダを作成
   - `mimeType: 'application/vnd.google-apps.folder'`

2. **ファイルアップロード機能**が必要
   - Google Drive API の `files.create` メソッドでファイルをアップロード
   - メタデータに企業名、契約番号を含める

3. **ファイル一覧取得機能**が必要
   - Google Drive API の `files.list` メソッドで特定フォルダ配下のファイルを取得
   - 契約業務フローダッシュボードで表示

---

**調査完了日**: 2025年10月11日
**調査者**: Claude Code
**次の作業**: 開発フローの進捗状況を更新し、フェーズ2完了報告
