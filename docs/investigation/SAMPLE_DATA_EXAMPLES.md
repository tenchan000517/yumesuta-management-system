# サンプルデータ例

このドキュメントでは、各マスターシートの実際のデータ例を示します。

---

## 新工程マスター（サンプル20工程）

### S系・A系（全体企画・メインインタビュー）

| 工程No | 工程名 | 工数 | 担当区分 | 優先度 | 必要データ | 作業カテゴリ |
|--------|--------|-----|---------|--------|-----------|------------|
| S-1 | ゆめマガ○月号企画決定 | 0 | 制作陣 | クリティカル | - | その他 |
| S-2 | ゆめマガ○月号企画書作成 | 2 | 制作陣 | クリティカル | - | 企画書作成 |
| A-1 | メインインタビュー実施日報告 | 0 | インタビュワー・撮影陣 | クリティカル | - | その他 |
| A-2 | メインインタビューデータ提出・撮影 | 0 | インタビュワー・撮影陣 | クリティカル | - | その他 |
| A-3 | メイン文字起こし | 1 | 制作陣 | クリティカル | 録音データ | 文字起こし |
| A-4 | メイン内容整理 | 1 | 制作陣 | クリティカル | - | 内容整理 |
| A-5 | キャッチコピー抽出 | 1 | 制作陣 | クリティカル | - | コピー抽出 |
| A-6 | 写真レタッチ | 1 | 制作陣 | クリティカル | 写真 | レタッチ |
| A-12 | メインページ制作（P4-5） | 3 | 制作陣 | クリティカル | - | ページ制作 |
| A-13 | 内部チェック | 1 | 制作陣 | クリティカル | - | 内部チェック |
| A-14 | 表紙確認送付 | 0 | インタビュワー・撮影陣 | クリティカル | - | その他 |
| A-15 | メインページ確認送付 | 0 | インタビュワー・撮影陣 | クリティカル | - | その他 |

### L系・M系（カスタム企画）

| 工程No | 工程名 | 工数 | 担当区分 | 優先度 | 必要データ | 作業カテゴリ |
|--------|--------|-----|---------|--------|-----------|------------|
| L-1 | 企画内容報告 | 0 | インタビュワー・撮影陣 | 高 | - | その他 |
| L-3 | ネーム作成 | 3 | 制作陣 | 高 | 企画内容 | ネーム作成 |
| L-4 | データ提出・撮影 | 0 | インタビュワー・撮影陣 | 高 | - | その他 |
| L-5 | 文字起こし | 1 | 制作陣 | 高 | 録音データ | 文字起こし |
| L-6 | 内容整理 | 1 | 制作陣 | 高 | - | 内容整理 |
| L-7 | 学校写真レタッチ | 1 | 制作陣 | 高 | 写真 | レタッチ |
| L-8 | ページ制作 | 3 | 制作陣 | 高 | - | ページ制作 |
| L-9 | 内部チェック | 1 | 制作陣 | 高 | - | 内部チェック |

### Z系（最終工程）

| 工程No | 工程名 | 工数 | 担当区分 | 優先度 | 確定締切 | 期間指定 | 作業カテゴリ |
|--------|--------|-----|---------|--------|---------|---------|------------|
| Z-1 | 全ページ完成 | 0 | 制作陣 | クリティカル | - | - | その他 |
| Z-2 | 最終チェック | 3 | 制作陣 | クリティカル | 27 | 26-27 | その他 |
| Z-3 | 校了日 | 0 | 制作陣 | クリティカル | 28 | - | その他 |
| Z-4 | 予備日 | 0 | 制作陣 | クリティカル | 29 | - | その他 |
| Z-5 | 入稿日 | 0 | 制作陣 | クリティカル | 30 | - | その他 |

---

## 新依存関係マスター（サンプル30依存関係）

### 基本的な順次実行（開始前）

| 工程No | 前提工程 | 依存タイプ | 日数 | 説明 |
|--------|---------|-----------|-----|------|
| S-2 | S-1 | 開始前 | 0 | 企画決定後に企画書作成 |
| A-1 | S-2 | 開始前 | 0 | 企画書完成後にインタビュー実施日報告 |
| A-2 | A-1 | 開始前 | 0 | 実施日報告後にデータ提出 |
| A-6 | A-2 | 開始前 | 0 | データ提出後に写真レタッチ |
| A-3 | A-6 | 開始前 | 0 | レタッチ後に文字起こし |
| A-4 | A-3 | 開始前 | 0 | 文字起こし後に内容整理 |
| A-12 | A-4 | 開始前 | 0 | 内容整理後にページ制作 |
| A-13 | A-11 | 開始前 | 0 | 表紙完成後に内部チェック |
| A-14 | A-13 | 開始前 | 0 | 内部チェック後に表紙確認送付 |
| A-15 | A-13 | 開始前 | 0 | 内部チェック後にメインページ確認送付 |

### 同日実行可能（同日可）

| 工程No | 前提工程 | 依存タイプ | 日数 | 説明 |
|--------|---------|-----------|-----|------|
| A-5 | A-4 | 同日可 | 0 | 内容整理と同日にコピー抽出可能 |
| A-7 | A-6 | 同日可 | 0 | レタッチと同日に写真選定可能 |
| A-8 | A-6 | 同日可 | 0 | レタッチと同日に加工依頼可能 |
| A-9 | A-8 | 同日可 | 0 | 加工依頼と同日にイラスト作成可能 |
| H-5 | H-4 | 同日可 | 0 | 内容整理と同日にコピー作成可能 |
| H-6 | H-2 | 同日可 | 0 | データ提出と同日にレタッチ可能 |

### 先方確認待機期間（7日より前）

| 工程No | 前提工程 | 依存タイプ | 日数 | 説明 |
|--------|---------|-----------|-----|------|
| K-6 | K-5 | 7日より前 | 7 | ページ制作の7日後に内部チェック |
| L-10 | L-9 | 7日より前 | 7 | 内部チェックの7日後に先方確認送付 |
| M-10 | M-9 | 7日より前 | 7 | 内部チェックの7日後に先方確認送付 |
| H-9 | H-8 | 7日より前 | 7 | 内部チェックの7日後に確認送付 |
| I-9 | I-8 | 7日より前 | 7 | 内部チェックの7日後に確認送付 |
| C-8 | C-7 | 7日より前 | 7 | 内部チェックの7日後に先方確認送付 |

### 複数工程の集約

| 工程No | 前提工程 | 依存タイプ | 日数 | 説明 |
|--------|---------|-----------|-----|------|
| B-1 | A-13 | 開始前 | 0 | メイン内部チェック完了後 |
| B-1 | K-6 | 開始前 | 0 | インタビュー②内部チェック完了後 |
| B-1 | L-9 | 開始前 | 0 | L系内部チェック完了後 |
| B-1 | M-9 | 開始前 | 0 | M系内部チェック完了後 |
| B-1 | H-8 | 開始前 | 0 | STAR①内部チェック完了後 |
| B-1 | I-8 | 開始前 | 0 | STAR②内部チェック完了後 |

→ B-1（全企画タイトル確定）は全企画の内部チェック完了後に実行

---

## カテゴリ同期マスター（全13グループ）

| カテゴリグループ | 同期工程配列 | 理想実行日 | 優先度 | 効率ボーナス | 説明 |
|----------------|-------------|-----------|-------|------------|------|
| 文字起こし | A-3,K-3,L-5,M-5,H-3,I-3 | 9 | 1 | 1.2 | 音声データの一括処理で効率向上 |
| 内容整理 | A-4,K-4,L-6,M-6,H-4,I-4 | 10 | 1 | 1.2 | 情報整理の集中実行で品質統一 |
| コピー抽出 | A-5,H-5,I-5 | 10 | 2 | 1.1 | キャッチコピー作成の同日実行 |
| レタッチ | L-7,M-7,H-6,I-6 | 11 | 2 | 1.1 | 写真加工の一括処理で色調統一 |
| 表紙関連 | A-6,A-7,A-8 | 8 | 1 | 1.3 | 表紙制作工程の連携実行 |
| ページ制作_メイン | A-12 | 12 | 1 | 1.0 | メインページの単独実行 |
| ページ制作_サブ1 | K-5 | 12 | 2 | 0.9 | メインとの部分重複許容 |
| ページ制作_サブ2 | L-8,M-8,H-7,I-7 | 14 | 3 | 0.8 | 完全重複による効率化 |
| 内部チェック_1 | A-13,C-7,E-3,P-3 | 15 | 2 | 1.1 | ページ完成後の一括チェック |
| 内部チェック_2 | L-9,M-9,K-6,H-8,I-8 | 16 | 2 | 1.1 | 後続ページの一括チェック |
| 確認送付 | A-14,A-15,K-7,L-10,M-10,H-9,I-9,C-8,E-4,P-4 | 18 | 1 | 1.2 | 一斉確認送付で回答効率化 |
| 修正対応 | L-11,M-11 | 19 | 3 | 1.0 | 修正作業の並行実行 |
| 最終工程 | Z-2,Z-3,Z-4,Z-5 | 24 | 1 | 1.0 | 最終段階の連続実行 |

---

## 負荷制約マスター（全8件）

| 担当者 | 最大同時実行数 | 最大負荷_人日 | 制限カテゴリ | 適用期間_開始日 | 適用期間_終了日 | 説明 |
|--------|--------------|--------------|------------|---------------|---------------|------|
| 制作陣 | 3 | 6 | ページ制作,ネーム作成 | 1 | 30 | 制作陣の基本制約 |
| 制作陣 | 1 | 3 | ページ制作 | 12 | 16 | ページ制作期間の厳格制限 |
| 制作陣 | 2 | 4 | その他 | 17 | 20 | 最終段階での負荷軽減 |
| インタビュワー・撮影陣 | 5 | 8 | すべて | 1 | 30 | インタビュワーの基本制約 |
| インタビュワー・撮影陣 | 2 | 4 | 確認送付 | 18 | 24 | 確認期間の集中対応制限 |
| 制作陣 | 0 | 0 | 新規案件,変更対応 | 14 | 20 | 新規案件厳禁期間 |
| 制作陣 | 1 | 2 | 修正対応 | 21 | 26 | 修正対応期間の制限 |
| 制作陣 | 2 | 3 | 最終チェック | 24 | 28 | 最終段階の慎重対応 |

---

## 期間制約マスター（全8期間）

| 期間名 | 開始日 | 終了日 | 許可カテゴリ | 禁止カテゴリ | 制約優先度 | 背景色 | 説明 |
|--------|-------|-------|------------|------------|---------|--------|------|
| 新規案件可能期間 | 1 | 6 | 企画書作成,ネーム作成,その他 | ページ制作,内部チェック | 1 | #E1F5FE | 新規案件の受入可能期間 |
| 方向性修正期間 | 7 | 13 | 文字起こし,内容整理,レタッチ,その他 | 新規案件 | 2 | #E8F5E8 | 企画方向性の調整可能期間 |
| 新規案件厳禁期間 | 14 | 20 | ページ制作,内部チェック,レタッチ | 新規案件,企画変更 | 1 | #FFE5E5 | 新規受入を完全禁止 |
| 確認期間 | 21 | 26 | 確認送付,修正対応,内部チェック | 新規案件,ページ制作 | 1 | #FFF9C4 | 外部確認とその対応期間 |
| 変更不可期間 | 27 | 30 | 最終チェック,校了,入稿 | すべての変更作業 | 1 | #F5F5F5 | 変更を一切受け付けない期間 |
| 回答待ち期間 | 19 | 24 | 修正対応 | 新規作業,確認送付 | 2 | #FFCCCC | 外部からの回答待ち期間 |
| データ提出集中期間 | 8 | 9 | データ提出,撮影 | 重い作業 | 3 | #E8F5FF | データ提出の集中期間 |
| 作業集中期間 | 10 | 11 | 文字起こし,内容整理 | 新規案件 | 3 | #F0FFF0 | 同種作業の集中実行期間 |

---

## 進捗入力シート（サンプル10工程）

| 工程No | 工程名 | 必要データ | 月号 | 逆算予定日 | 入力予定日 | 実績日 | 先方確認ステータス | ステータス | 備考 |
|--------|--------|-----------|-----|-----------|-----------|--------|-----------------|----------|------|
| K-2 | インタビュー②データ提出 | 録音データ | | 9/28 | | 2025-10-07 | | active | 録音データ提出完了日を入力 |
| H-2 | STAR①データ提出 | 録音データ | | 9/28 | | | 確認待ち | active | 録音データ提出完了日を入力 |
| A-14 | 表紙確認送付 | - | | 10/5 | | | 確認待ち | active | |
| H-9 | STAR①確認送付 | - | | 10/5 | | | 確認待ち | active | |
| L-1 | 企画内容報告 | 企画内容 | | 10/17 | | | | active | 企画内容報告完了日を入力 |
| M-1 | 企画内容報告 | 企画内容 | | 10/18 | | | | active | 企画内容報告完了日を入力 |
| S-1 | ゆめマガ○月号企画決定 | - | | 10/15 | | | | active | |
| B-1 | 全企画タイトル確定 | - | | 10/14 | | | | active | |
| Z-1 | 全ページ完成 | - | | 10/15 | | | | active | |
| Z-5 | 入稿日 | - | | 10/20 | | | | active | |

---

## ガントシート（サンプル10工程の日付配置）

### Layer 3（素材準備）

| 工程 | レイヤー | 配置理由 | 9/21 | 9/22 | ... | 9/29 | 9/30 | 10/1 | ... |
|------|---------|---------|------|------|-----|------|------|------|-----|
| A-3 メイン文字起こし | Layer 3 | 文字起こし同期: 9日目 | | | | A-3 | | | |
| A-4 メイン内容整理 | Layer 3 | 内容整理同期: 10日目 | | | | | A-4 | | |
| K-3 インタビュー②文字起こし | Layer 3 | 文字起こし同期: 9日目 | | | | K-3 | | | |
| K-4 インタビュー②内容整理 | Layer 3 | 内容整理同期: 10日目 | | | | | K-4 | | |
| L-5 文字起こし | Layer 3 | 文字起こし同期: 9日目 | | | | L-5 | | | |
| L-6 内容整理 | Layer 3 | 内容整理同期: 10日目 | | | | | L-6 | | |
| L-7 学校写真レタッチ | Layer 3 | レタッチ同期: 11日目 | | | | | | L-7 | |

→ 文字起こし6工程が9/29（9日目）に同期配置
→ 内容整理6工程が9/30（10日目）に同期配置

### Layer 4（ページ制作）

| 工程 | レイヤー | 配置理由 | 10/2 | 10/3 | 10/4 | 10/5 | ... |
|------|---------|---------|------|------|------|------|-----|
| A-12 メインページ制作（P4-5） | Layer 4 | ページ制作分散: 12日目開始 | A-12 | A-12 | A-12 | | |
| K-5 インタビュー②ページ制作 | Layer 4 | ページ制作分散: 13日目開始 | | K-5 | K-5 | | |
| L-8 ページ制作 | Layer 4 | ページ制作分散: 14日目開始 | | | L-8 | L-8 | L-8 |

→ ページ制作は分散配置（同時実行数を制限）

### Layer 1（最終工程）

| 工程 | レイヤー | 配置理由 | 10/15 | 10/16 | 10/17 | 10/18 | 10/19 | 10/20 |
|------|---------|---------|-------|-------|-------|-------|-------|-------|
| Z-1 全ページ完成 | Layer 1 | Z系絶対締切: 25日目 | Z-1 | | | | | |
| Z-2 最終チェック | Layer 1 | Z系絶対締切: 26日目 | | Z-2 | Z-2 | | | |
| Z-3 校了日 | Layer 1 | Z系絶対締切: 28日目 | | | | Z-3 | | |
| Z-4 予備日 | Layer 1 | Z系絶対締切: 29日目 | | | | | Z-4 | |
| Z-5 入稿日 | Layer 1 | Z系絶対締切: 30日目 | | | | | | Z-5 |

→ 最終工程は逆算配置（入稿日から逆算）

---

## 実装時のデータ取得例

### TypeScript型定義

```typescript
interface YumemagaProcess {
  processNo: string;        // "A-3"
  processName: string;      // "メイン文字起こし"
  workDays: number;         // 1
  assignedTo: string;       // "制作陣"
  priority: string;         // "クリティカル"
  requiredData: string;     // "録音データ"
  category: string;         // "文字起こし"

  // 進捗入力シートから
  scheduledDate?: string;   // "9/29"
  actualDate?: string;      // "2025-10-07"
  confirmationStatus?: string; // "確認待ち"
  status: string;           // "active"

  // ガントシートから
  layer?: string;           // "Layer 3"
  placementReason?: string; // "文字起こし同期: 9日目"
  dates?: string[];         // ["9/29"]
}

interface YumemagaDependency {
  processNo: string;        // "A-4"
  prerequisite: string;     // "A-3"
  dependencyType: string;   // "開始前"
  days: number;            // 0
}

interface YumemagaCategorySync {
  categoryGroup: string;    // "文字起こし"
  processes: string[];      // ["A-3", "K-3", "L-5", "M-5", "H-3", "I-3"]
  idealDay: number;        // 9
  priority: number;        // 1
  efficiencyBonus: number; // 1.2
  description: string;     // "音声データの一括処理で効率向上"
}
```

### API実装例

```typescript
// /app/api/yumemaga-sheets/route.ts
export async function GET() {
  const ranges = [
    '新工程マスター!A2:I1000',
    '進捗入力シート!A2:J1000',
    '逆算配置_ガント_2025年11月号!A1:BL100',
    '新依存関係マスター!A2:D1000',
    'カテゴリ同期マスター!A2:F20',
  ];

  const [processes, progress, gantt, dependencies, categorySync] =
    await getBatchSheetData(YUMEMAGA_SPREADSHEET_ID, ranges);

  // Parse and merge data
  const mergedData = mergeProcessData(processes, progress, gantt);

  return NextResponse.json({
    success: true,
    data: {
      processes: mergedData,
      dependencies: parseDependencies(dependencies),
      categorySync: parseCategorySync(categorySync),
      totalProcesses: mergedData.length,
    }
  });
}
```

---

## まとめ

このサンプルデータから、以下が確認できます：

1. **工程の詳細度**: 96工程が明確に定義され、工数・担当・優先度が設定
2. **依存関係の厳密性**: 108件の依存関係で前後関係を完全に管理
3. **カテゴリ同期の効果**: 同種作業を同日実行で1.1～1.3倍の効率化
4. **負荷制約の実用性**: 期間別に同時実行数を制限（14～20日は新規案件0）
5. **期間制約の明確性**: 5段階の期間で作業内容を厳格に管理
6. **ガント配置の完全性**: 全工程に日付が配置済み（空白なし）

これらのデータを活用することで、高度な工程管理ダッシュボードを実装できます。
