# ゆめマガスプレッドシート構造調査レポート

調査日時: 2025-10-07
調査対象: YUMEMAGA_SPREADSHEET_ID (1qC3cMSGv8kjt6aoK20IvbaFfD3oLfvTTrFKUU_gQXhw)
調査API: http://localhost:3000/api/investigate-process-sheets

## 目次

1. [スプレッドシート概要](#スプレッドシート概要)
2. [全シート一覧](#全シート一覧)
3. [新工程マスター](#新工程マスター)
4. [新依存関係マスター](#新依存関係マスター)
5. [設定マスター](#設定マスター)
6. [カテゴリ同期マスター](#カテゴリ同期マスター)
7. [負荷制約マスター](#負荷制約マスター)
8. [期間制約マスター](#期間制約マスター)
9. [進捗入力シート](#進捗入力シート)
10. [ガントシート](#ガントシート)
11. [まとめと推奨事項](#まとめと推奨事項)

---

## スプレッドシート概要

このスプレッドシートは、ゆめマガの制作工程を管理するための高度な逆算スケジューリングシステムです。

**主要な特徴:**
- 96工程の詳細な工程管理
- 108件の工程間依存関係
- カテゴリ同期による効率化
- 負荷制約と期間制約による最適化
- 逆算配置によるガントチャート自動生成

---

## 全シート一覧

| # | シート名 | Sheet ID | 用途 |
|---|---------|----------|------|
| 0 | シート1 | 0 | 未使用（空） |
| 1 | カテゴリ同期マスター | 1771253255 | 同種作業の同期設定 |
| 2 | 負荷制約マスター | 2128428735 | 担当者の負荷制約 |
| 3 | 期間制約マスター | 1796462541 | 期間別の作業制約 |
| 4 | 拡張工程マスター | 1564166483 | 工程の拡張情報 |
| 5 | 設定マスター | 1598704762 | システム設定 |
| 6 | 新依存関係マスター | 983423705 | 工程間の依存関係 |
| 7 | 新工程マスター | 1045956022 | 全工程の基本情報 |
| 8 | 理想形_ガント_2025年11月号 | 548026099 | 理想スケジュール |
| 9 | 逆算配置_ガント_2025年11月号 | 1583399674 | 実際の逆算スケジュール |
| 10 | 理想形_ガント_2025年10月号 | 63049515 | 過去号の理想スケジュール |
| 11 | 工程マスター確認 | 820132991 | 工程確認用 |
| 12 | 進捗入力シート | 1472299859 | 実績入力用 |
| 13 | カレンダーマスター | 1158424563 | カレンダー設定 |

---

## 新工程マスター

**Sheet ID:** 1045956022
**Dimensions:** 1000行 × 26列
**Total Processes:** 96工程

### 列構成

| 列名 | 説明 |
|------|------|
| 工程No | 工程の一意識別子（例: A-1, K-2, L-3） |
| 工程名 | 工程の名称 |
| 工数 | 必要日数（0-3日） |
| 担当区分 | 制作陣 / インタビュワー・撮影陣 |
| 優先度 | クリティカル / 高 / 中 |
| 必要データ | 録音データ / 写真 / 情報シート / - |
| 確定締切 | 絶対締切日（日数） |
| 期間指定 | 作業可能期間（例: 1-13） |
| 作業カテゴリ | 文字起こし / ページ制作 / レタッチ等 |

### 作業カテゴリ分類

| カテゴリ | 件数 | 説明 |
|---------|-----|------|
| その他 | 55件 | 報告・送付・確認等の軽作業 |
| 内部チェック | 9件 | ページ完成後の品質チェック |
| ページ制作 | 8件 | メインコンテンツ制作 |
| 文字起こし | 6件 | インタビュー音声の文字起こし |
| 内容整理 | 6件 | 文字起こし後の情報整理 |
| レタッチ | 6件 | 写真の加工・調整 |
| コピー抽出 | 3件 | キャッチコピーの作成 |
| ネーム作成 | 2件 | ページレイアウト案作成 |
| 企画書作成 | 1件 | 月号の企画書 |

### 工程系統の分類

**S系（全体企画）:**
- S-1: 企画決定
- S-2: 企画書作成

**A系（メインインタビュー）:**
- A-1～A-15: メイン記事制作フロー（17工程）
- 表紙制作を含む

**K系（インタビュー②）:**
- K-1～K-7: サブインタビュー制作（7工程）

**L系・M系（カスタム企画）:**
- L-1～L-11: 学校特集等（11工程）
- M-1～M-12: カスタム企画（12工程）

**H系・I系（STAR企画）:**
- H-1～H-9: STAR①（9工程）
- I-1～I-9: STAR②（9工程）
- J-1: STAR企画導入ページ

**C系（新規企業）:**
- C-1～C-9: 新規企業追加フロー（9工程）

**E系・P系（既存修正）:**
- E-1～E-5: 既存企業修正（5工程）
- P-1～P-5: パートナー修正（5工程）

**F系（固定ページ）:**
- F-1～F-3: 闇バイト注意喚起、デジタルプラットフォーム、裏表紙

**B系（目次）:**
- B-1: 全企画タイトル確定
- B-2: 目次作成

**N系（全体修正）:**
- N-1: 全体修正対応

**Z系（最終工程）:**
- Z-1～Z-5: 全ページ完成、最終チェック、校了、予備日、入稿

### 優先度分布

- **クリティカル:** 最重要工程（A系、K系、Z系等）
- **高:** 重要企画（L系、M系、H系、I系等）
- **中:** 修正対応（E系、P系、F系）

### 担当区分

- **制作陣:** ページ制作、レタッチ、チェック等の制作作業
- **インタビュワー・撮影陣:** インタビュー実施、データ提出、確認送付等

---

## 新依存関係マスター

**Sheet ID:** 983423705
**Dimensions:** 1000行 × 26列
**Total Dependencies:** 108件

### 列構成

| 列名 | 説明 |
|------|------|
| 工程No | この工程 |
| 前提工程 | この工程より前に完了すべき工程 |
| 依存タイプ | 開始前 / 同日可 / 7日より前 |
| 日数 | 必要な間隔日数 |

### 依存タイプ分類

| 依存タイプ | 件数 | 説明 |
|-----------|-----|------|
| 開始前 | 77件 | 前提工程が完了してから開始 |
| 7日より前 | 18件 | 前提工程の7日以上前に完了必要 |
| 同日可 | 13件 | 同日実行可能 |

### 主要な依存関係パターン

**1. 順次実行（開始前）:**
```
S-1 → S-2 → A-1 → A-2 → A-6 → A-3 → A-4 → A-12 → A-13 → A-14/A-15
```

**2. 並列実行可能（同日可）:**
```
A-6 → A-7（同日可）
A-6 → A-8（同日可）
```

**3. 先方確認待機期間（7日より前）:**
```
K-6 → K-5（7日より前）
L-10 → L-9（7日より前）
```

**4. 複数工程の集約（B-1の例）:**
```
A-13, K-6, L-9, M-9, H-8, I-8, C-7, E-3, P-3 → B-1
```
→ 全企画が内部チェック完了後にタイトル確定

**5. 最終工程への集約（Z-1の例）:**
```
A-14, A-15, K-7, L-10, M-10, H-9, I-9, C-8, E-4, P-4 → Z-1（各7日より前）
```
→ 全確認送付の7日後に全ページ完成

---

## 設定マスター

**Sheet ID:** 1598704762
**Dimensions:** 1000行 × 26列

### 現在の設定値

| 項目名 | 設定値 | 備考 |
|--------|--------|------|
| 対象年 | 2025 | 月号の発行年 |
| 対象月号 | 11 | 作成する月号（11=11月号） |
| 開始月オフセット | -2 | 2ヶ月前から開始 |
| 開始日 | 21 | 開始する日（21日） |
| 締切日 | 20 | 締切の日（20日） |
| 計算開始日 | 2025/09/21 | 自動計算される開始日 |
| 計算終了日 | 2025/11/20 | 自動計算される終了日 |

### スケジュール計算ロジック

- **作業期間:** 2025/09/21～2025/11/20（61日間）
- **開始:** 発行月の2ヶ月前の21日
- **締切:** 発行月の前月20日

---

## カテゴリ同期マスター

**Sheet ID:** 1771253255
**Total Sync Groups:** 13グループ

### カテゴリ同期設定

| カテゴリグループ | 同期工程 | 理想実行日 | 優先度 | 効率ボーナス | 説明 |
|----------------|---------|-----------|-------|------------|------|
| 文字起こし | A-3, K-3, L-5, M-5, H-3, I-3 | 9日目 | 1 | 1.2 | 音声データの一括処理で効率向上 |
| 内容整理 | A-4, K-4, L-6, M-6, H-4, I-4 | 10日目 | 1 | 1.2 | 情報整理の集中実行で品質統一 |
| コピー抽出 | A-5, H-5, I-5 | 10日目 | 2 | 1.1 | キャッチコピー作成の同日実行 |
| レタッチ | L-7, M-7, H-6, I-6 | 11日目 | 2 | 1.1 | 写真加工の一括処理で色調統一 |
| 表紙関連 | A-6, A-7, A-8 | 8日目 | 1 | 1.3 | 表紙制作工程の連携実行 |
| ページ制作_メイン | A-12 | 12日目 | 1 | 1.0 | メインページの単独実行 |
| ページ制作_サブ1 | K-5 | 12日目 | 2 | 0.9 | メインとの部分重複許容 |
| ページ制作_サブ2 | L-8, M-8, H-7, I-7 | 14日目 | 3 | 0.8 | 完全重複による効率化 |
| 内部チェック_1 | A-13, C-7, E-3, P-3 | 15日目 | 2 | 1.1 | ページ完成後の一括チェック |
| 内部チェック_2 | L-9, M-9, K-6, H-8, I-8 | 16日目 | 2 | 1.1 | 後続ページの一括チェック |
| 確認送付 | A-14, A-15, K-7, L-10, M-10, H-9, I-9, C-8, E-4, P-4 | 18日目 | 1 | 1.2 | 一斉確認送付で回答効率化 |
| 修正対応 | L-11, M-11 | 19日目 | 3 | 1.0 | 修正作業の並行実行 |
| 最終工程 | Z-2, Z-3, Z-4, Z-5 | 24日目 | 1 | 1.0 | 最終段階の連続実行 |

### カテゴリ同期の意義

同種作業を同じ日に実行することで：
- 作業効率の向上（1.1～1.3倍のボーナス）
- 品質の統一（特に文字起こし、内容整理）
- 確認作業の効率化（一斉送付で回答時間短縮）

---

## 負荷制約マスター

**Sheet ID:** 2128428735
**Total Constraints:** 8件

### 負荷制約設定

| 担当者 | 最大同時実行数 | 最大負荷 | 制限カテゴリ | 適用期間 | 説明 |
|--------|--------------|---------|------------|---------|------|
| 制作陣 | 3 | 6人日 | ページ制作、ネーム作成 | 1～30日 | 基本制約 |
| 制作陣 | 1 | 3人日 | ページ制作 | 12～16日 | ページ制作期間の厳格制限 |
| 制作陣 | 2 | 4人日 | その他 | 17～20日 | 最終段階での負荷軽減 |
| 制作陣 | 0 | 0人日 | 新規案件、変更対応 | 14～20日 | 新規案件厳禁期間 |
| 制作陣 | 1 | 2人日 | 修正対応 | 21～26日 | 修正対応期間の制限 |
| 制作陣 | 2 | 3人日 | 最終チェック | 24～28日 | 最終段階の慎重対応 |
| インタビュワー・撮影陣 | 5 | 8人日 | すべて | 1～30日 | 基本制約 |
| インタビュワー・撮影陣 | 2 | 4人日 | 確認送付 | 18～24日 | 確認期間の集中対応制限 |

### 重要な制約

**新規案件厳禁期間（14～20日目）:**
- 最大同時実行数: 0
- 最大負荷: 0人日
- この期間は新規受入を完全禁止

**ページ制作期間の厳格制限（12～16日目）:**
- 最大同時実行数: 1
- 同時に1つのページ制作のみ許可

---

## 期間制約マスター

**Sheet ID:** 1796462541
**Total Constraints:** 8期間

### 期間制約設定

| 期間名 | 開始日 | 終了日 | 許可カテゴリ | 禁止カテゴリ | 優先度 | 背景色 |
|--------|-------|-------|------------|------------|-------|--------|
| 新規案件可能期間 | 1 | 6 | 企画書作成、ネーム作成、その他 | ページ制作、内部チェック | 1 | #E1F5FE |
| 方向性修正期間 | 7 | 13 | 文字起こし、内容整理、レタッチ、その他 | 新規案件 | 2 | #E8F5E8 |
| 新規案件厳禁期間 | 14 | 20 | ページ制作、内部チェック、レタッチ | 新規案件、企画変更 | 1 | #FFE5E5 |
| 確認期間 | 21 | 26 | 確認送付、修正対応、内部チェック | 新規案件、ページ制作 | 1 | #FFF9C4 |
| 変更不可期間 | 27 | 30 | 最終チェック、校了、入稿 | すべての変更作業 | 1 | #F5F5F5 |
| 回答待ち期間 | 19 | 24 | 修正対応 | 新規作業、確認送付 | 2 | #FFCCCC |
| データ提出集中期間 | 8 | 9 | データ提出、撮影 | 重い作業 | 3 | #E8F5FF |
| 作業集中期間 | 10 | 11 | 文字起こし、内容整理 | 新規案件 | 3 | #F0FFF0 |

### スケジュールの5段階構造

```
┌─────────────────────────────────────────────────────────────┐
│ 1-6日目   │ 新規案件可能期間                                  │
│           │ 企画書作成、ネーム作成開始                          │
├─────────────────────────────────────────────────────────────┤
│ 7-13日目  │ 方向性修正期間                                    │
│           │ データ提出、文字起こし、内容整理、レタッチ集中期間    │
├─────────────────────────────────────────────────────────────┤
│ 14-20日目 │ 新規案件厳禁期間                                  │
│           │ ページ制作、内部チェックに集中                      │
├─────────────────────────────────────────────────────────────┤
│ 21-26日目 │ 確認期間                                         │
│           │ 先方確認送付、回答待ち、修正対応                    │
├─────────────────────────────────────────────────────────────┤
│ 27-30日目 │ 変更不可期間                                      │
│           │ 最終チェック、校了、予備日、入稿                    │
└─────────────────────────────────────────────────────────────┘
```

---

## 進捗入力シート

**Sheet ID:** 1472299859
**Dimensions:** 1000行 × 26列
**Total Processes:** 96工程

### 列構成

| 列名 | 説明 |
|------|------|
| 工程No | 工程の一意識別子 |
| 工程名 | 工程の名称 |
| 必要データ | 録音データ / 写真 / 情報シート / - |
| 月号 | 対象月号 |
| 逆算予定日 | システムが計算した予定日 |
| 入力予定日 | 手動で入力した予定日 |
| 実績日 | 実際の完了日（手動入力） |
| 先方確認ステータス | 確認待ち / 確認済み |
| ステータス | active / completed / blocked |
| 備考 | 備考欄 |

### 現在の進捗状況（2025-10-07時点）

**実績日が入力されている工程:**
- K-2: インタビュー②データ提出（実績日: 2025-10-07）

**先方確認待ち:**
- H-2: STAR①データ提出
- A-14: 表紙確認送付
- H-9: STAR①確認送付

**ステータス分布:**
- active: 96件（全工程）

### 進捗管理の仕組み

1. **逆算予定日:** ガントシートから自動計算
2. **入力予定日:** 手動で調整可能
3. **実績日:** 実際の完了日を手動入力
4. **先方確認ステータス:** 外部確認の追跡

---

## ガントシート

**Sheet Name:** 逆算配置_ガント_2025年11月号
**Sheet ID:** 1583399674
**Dimensions:** 1000行 × 64列

### 列構成

| 列 | 内容 |
|----|------|
| A | 工程名 |
| B | レイヤー（Layer 1-6、次月号） |
| C | 配置理由 |
| D～BL | 日付列（9/21～11/20の61日間） |

### レイヤー分布

| レイヤー | 件数 | 説明 |
|---------|-----|------|
| Layer 1 | 5件 | 最終工程（Z系） |
| Layer 2 | 2件 | 全企画タイトル確定、目次作成 |
| Layer 3 | 24件 | データ提出、文字起こし、内容整理、レタッチ |
| Layer 4 | 7件 | ページ制作 |
| Layer 5 | 10件 | 先方確認送付 |
| Layer 6 | 15件 | 内部チェック、修正対応 |
| 次月号 | 14件 | 次月号の初期作業 |

### レイヤーの意味

- **Layer 1:** 絶対締切（入稿日等）
- **Layer 2:** 全体統合作業
- **Layer 3:** 素材準備
- **Layer 4:** コンテンツ制作
- **Layer 5:** 外部確認
- **Layer 6:** 品質保証・修正

### ガントシートの特徴

**全工程に日付が配置済み:**
- 日付が入っていない工程: 0件
- すべての工程が逆算配置完了

**配置理由の分類:**
- 文字起こし同期: 9日目
- 内容整理同期: 10日目
- レタッチ同期: 11日目
- ページ制作分散: 12～19日目
- 内部チェック完了後の確認送付
- 依存関係による配置
- Z系絶対締切: 25～30日目

---

## まとめと推奨事項

### スプレッドシートの構造的特徴

1. **高度な制約条件管理**
   - 96工程、108依存関係、13カテゴリ同期
   - 負荷制約、期間制約による最適化
   - 効率ボーナスによる同期推奨

2. **逆算スケジューリング**
   - 入稿日（30日目）から逆算
   - 依存関係を考慮した自動配置
   - カテゴリ同期による効率化

3. **レイヤー構造**
   - Layer 1（絶対締切）から逆算
   - Layer 6まで段階的に配置
   - 次月号作業の並行実行

### システム実装への推奨事項

#### 1. 基本データ構造の型定義

```typescript
// types/yumemaga-process.ts
interface Process {
  processNo: string;        // 工程No (例: "A-1")
  processName: string;      // 工程名
  workDays: number;         // 工数
  assignedTo: '制作陣' | 'インタビュワー・撮影陣';
  priority: 'クリティカル' | '高' | '中';
  requiredData: string;     // 必要データ
  deadline?: number;        // 確定締切（日数）
  periodConstraint?: string; // 期間指定
  category: string;         // 作業カテゴリ
}

interface Dependency {
  processNo: string;        // この工程
  prerequisite: string;     // 前提工程
  dependencyType: '開始前' | '同日可' | '7日より前';
  days: number;            // 必要な間隔日数
}

interface CategorySync {
  categoryGroup: string;    // カテゴリグループ
  processes: string[];      // 同期工程配列
  idealDay: number;        // 理想実行日
  priority: number;        // 同期優先度
  efficiencyBonus: number; // 効率ボーナス
}
```

#### 2. API実装の段階的アプローチ

**Phase 1: 基本データ取得（現在のゆめマガダッシュボード強化）**
- 新工程マスターの全96工程取得
- 進捗入力シートとの統合
- ステータス表示の改善

**Phase 2: 依存関係可視化**
- 新依存関係マスターの108依存関係取得
- 工程間の前後関係を視覚化
- クリティカルパスの特定

**Phase 3: ガントチャート表示**
- 逆算配置ガントの61日間データ取得
- レイヤー別の色分け表示
- カテゴリ同期の視覚化

**Phase 4: 制約条件の反映**
- 負荷制約マスターによる警告表示
- 期間制約マスターによる背景色変更
- カテゴリ同期の推奨表示

#### 3. UI/UX の推奨設計

**ダッシュボードの4つの表示モード:**

1. **サマリービュー:**
   - 全96工程の進捗率
   - 遅延している工程の警告
   - 次のアクションアイテム

2. **タイムラインビュー:**
   - ガントチャート形式
   - レイヤー別の色分け
   - カテゴリ同期の強調表示

3. **依存関係ビュー:**
   - ネットワーク図形式
   - クリティカルパスの強調
   - ボトルネック工程の警告

4. **制約条件ビュー:**
   - 期間別の許可/禁止作業
   - 負荷状況のリアルタイム表示
   - 新規案件受入可否の判定

#### 4. データ取得の最適化

**シート読み取り優先順位:**
1. 設定マスター（対象月号の確認）
2. 進捗入力シート（実績データ）
3. 逆算配置ガント（予定データ）
4. 新工程マスター（工程定義）
5. 新依存関係マスター（依存関係）
6. カテゴリ同期マスター（同期推奨）
7. 負荷制約マスター（制約条件）
8. 期間制約マスター（期間制約）

**BatchSheetData API の活用:**
```typescript
const ranges = [
  '設定マスター!A1:Z100',
  '進捗入力シート!A1:Z1000',
  '逆算配置_ガント_2025年11月号!A1:BL100',
  '新工程マスター!A1:Z1000',
  '新依存関係マスター!A1:Z1000',
];
const data = await getBatchSheetData(spreadsheetId, ranges);
```

#### 5. 警告・推奨機能の実装

**自動警告:**
- 逆算予定日を過ぎた工程
- 依存関係が満たされていない工程
- 負荷制約を超過している日
- 期間制約に違反している作業

**推奨表示:**
- カテゴリ同期による効率化提案
- 同日実行可能な工程の提示
- クリティカルパスに影響する工程の強調

---

## 次のステップ

### 実装の優先順位

**Priority 1: 基本表示の改善（1-2日）**
- 現在のゆめマガダッシュボードに新工程マスターの全96工程を表示
- 進捗入力シートの実績日との統合
- カテゴリ別のグループ化表示

**Priority 2: ガントチャート実装（3-5日）**
- 逆算配置ガントの61日間表示
- レイヤー別の色分け
- 工程名と日付のマッピング

**Priority 3: 依存関係可視化（3-5日）**
- 新依存関係マスターの108依存関係表示
- クリティカルパスの計算
- 工程間の前後関係図

**Priority 4: 制約条件の反映（2-3日）**
- 期間制約マスターによる背景色変更
- 負荷制約マスターによる警告表示
- カテゴリ同期の推奨表示

---

## 調査結果サマリー

| 項目 | 値 |
|------|-----|
| 総シート数 | 14シート |
| 総工程数 | 96工程 |
| 依存関係数 | 108件 |
| カテゴリ同期グループ | 13グループ |
| 負荷制約 | 8件 |
| 期間制約 | 8期間 |
| ガント日数 | 61日間 |
| レイヤー数 | 7種類 |
| 作業カテゴリ | 9種類 |
| 担当区分 | 2種類 |
| 優先度 | 3段階 |

このスプレッドシートは、非常に高度な制約条件と依存関係を持つ、プロフェッショナルな制作工程管理システムです。
